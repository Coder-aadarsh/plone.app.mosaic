"use strict";(self.webpackChunkplone_mosaic=self.webpackChunkplone_mosaic||[]).push([[60185],{60185:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});a(35666);var i=a(99269),o=a.n(i),n=a(66227),s=a.n(n),r=a(89867),c=a(79277);a(41973);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function d(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){r=!0,n=e},f:function(){try{s||null==a.return||a.return()}finally{if(r)throw n}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}function u(){u=function(){return e};var e={},t=Object.prototype,a=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",n=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function r(e,t,a){return Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{r({},"")}catch(e){r=function(e,t,a){return e[t]=a}}function c(e,t,a,i){var o=t&&t.prototype instanceof h?t:h,n=Object.create(o.prototype),s=new _(i||[]);return n._invoke=function(e,t,a){var i="suspendedStart";return function(o,n){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw n;return T()}for(a.method=o,a.arg=n;;){var s=a.delegate;if(s){var r=z(s,a);if(r){if(r===m)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===i)throw i="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);i="executing";var c=d(e,t,a);if("normal"===c.type){if(i=a.done?"completed":"suspendedYield",c.arg===m)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(i="completed",a.method="throw",a.arg=c.arg)}}}(e,a,s),n}function d(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var m={};function h(){}function f(){}function p(){}var v={};r(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(k([])));y&&y!==t&&a.call(y,o)&&(v=y);var w=p.prototype=h.prototype=Object.create(v);function C(e){["next","throw","return"].forEach((function(t){r(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function i(o,n,s,r){var c=d(e[o],e,n);if("throw"!==c.type){var m=c.arg,u=m.value;return u&&"object"==l(u)&&a.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,s,r)}),(function(e){i("throw",e,s,r)})):t.resolve(u).then((function(e){m.value=e,s(m)}),(function(e){return i("throw",e,s,r)}))}r(c.arg)}var o;this._invoke=function(e,a){function n(){return new t((function(t,o){i(e,a,t,o)}))}return o=o?o.then(n,n):n()}}function z(e,t){var a=e.iterator[t.method];if(void 0===a){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,z(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=d(a,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function k(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(a.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=p,r(w,"constructor",p),r(p,"constructor",f),f.displayName=r(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,r(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},C(b.prototype),r(b.prototype,n,(function(){return this})),e.AsyncIterator=b,e.async=function(t,a,i,o,n){void 0===n&&(n=Promise);var s=new b(c(t,a,i,o),n);return e.isGeneratorFunction(a)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},C(w),r(w,s,"Generator"),r(w,o,(function(){return this})),r(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var a in e)t.push(a);return t.reverse(),function a(){for(;t.length;){var i=t.pop();if(i in e)return a.value=i,a.done=!1,a}return a.done=!0,a}},e.values=k,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(a,i){return s.type="throw",s.arg=e,t.next=a,i&&(t.method="next",t.arg=void 0),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o],s=n.completion;if("root"===n.tryLoc)return i("end");if(n.tryLoc<=this.prev){var r=a.call(n,"catchLoc"),c=a.call(n,"finallyLoc");if(r&&c){if(this.prev<n.catchLoc)return i(n.catchLoc,!0);if(this.prev<n.finallyLoc)return i(n.finallyLoc)}else if(r){if(this.prev<n.catchLoc)return i(n.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return i(n.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&a.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var s=n?n.completion:{};return s.type=e,s.arg=t,n?(this.method="next",this.next=n.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),E(a),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var i=a.completion;if("throw"===i.type){var o=i.arg;E(a)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:k(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),m}},e}function h(e,t,a,i,o,n,s){try{var r=e[n](s),c=r.value}catch(e){return void a(e)}r.done?t(c):Promise.resolve(c).then(i,o)}function f(e){return function(){var t=this,a=arguments;return new Promise((function(i,o){var n=e.apply(t,a);function s(e){h(n,i,o,s,r,"next",e)}function r(e){h(n,i,o,s,r,"throw",e)}s(void 0)}))}}function p(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v=r.Z.getLogger("pat-mosaic/layout"),g=function(){function e(t){var a,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o={widthClasses:["col","col-1","col-2","col-3","col-4","col-5","col-6","col-7","col-8","col-9","col-10","col-11","col-12"],dataClasses:["mosaic-col","mosaic-col-1","mosaic-col-2","mosaic-col-3","mosaic-col-4","mosaic-col-5","mosaic-col-6","mosaic-col-7","mosaic-col-8","mosaic-col-9","mosaic-col-10","mosaic-col-11","mosaic-col-12"],positionClasses:["mosaic-position-0","mosaic-position-1","mosaic-position-2","mosaic-position-3","mosaic-position-4","mosaic-position-5","mosaic-position-6","mosaic-position-7","mosaic-position-8","mosaic-position-9","mosaic-position-10","mosaic-position-11","mosaic-position-12"],resizeHandleClasses:["mosaic-resize-handle-1","mosaic-resize-handle-2","mosaic-resize-handle-3","mosaic-resize-handle-4","mosaic-resize-handle-5","mosaic-resize-handle-6","mosaic-resize-handle-7","mosaic-resize-handle-8","mosaic-resize-handle-9","mosaic-resize-handle-10","mosaic-resize-handle-11","mosaic-resize-handle-12"]},(i="layout")in(a=this)?Object.defineProperty(a,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[i]=o,this.mosaic=t}var t,a,i,n,r,l;return t=e,a=[{key:"disableEditHtmlSource",value:function(){o()(".mosaic-rich-text-textarea",this.mosaic.document).each((function(){var e,t;t=o()(this).val(),(e=o()(this).parent()).html(t),e.data("mosaic-tile").setupWysiwyg()}))}},{key:"addAppTile",value:function(e,t){var a,i=this;i.mosaic.overlay.app&&i.mosaic.overlay.app.hide(),o().ajax({type:"GET",url:t,success:(a=f(u().mark((function a(o){return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=i.mosaic.getDomTreeFromHtml(o),i.mosaic.addHeadTags(t,o),a.next=4,i.addTile(e,o.find(".temp_body_tag").html(),t);case 4:case"end":return a.stop()}}),a)}))),function(e){return a.apply(this,arguments)})})}},{key:"addAppTileHTML",value:(l=f(u().mark((function e(t,a,i){var o,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(n=this).mosaic.getDomTreeFromHtml(a),n.mosaic.addHeadTags(i,o),e.next=5,n.addTile(t,o.find(".temp_body_tag").html(),i);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return l.apply(this,arguments)})},{key:"editAppTile",value:function(e){var t=this;t.mosaic.overlay.close(),window.parent.focus(),o().ajax({type:"GET",url:e,success:function(a){a=t.mosaic.getDomTreeFromHtml(a),t.mosaic.removeHeadTags(e),t.mosaic.addHeadTags(e,a);var i=o()(".mosaic-selected-tile .mosaic-tile-content",t.mosaic.document);i.html(a.find(".temp_body_tag").html()),i.attr("data-tileUrl",e.replace(/&/gim,"&amp;"))}})}},{key:"addTile",value:(r=f(u().mark((function e(t,a,i){var n,s,r,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this).mosaic.panels.addClass("mosaic-panel-dragging mosaic-panel-dragging-new"),o()(n.mosaic.panels.get(0)).append(o()(n.mosaic.document.createElement("div")).addClass("mosaic-grid-row").append(o()(n.mosaic.document.createElement("div")).addClass("mosaic-grid-cell col").append(o()(n.mosaic.document.createElement("div")).addClass("movable removable mosaic-tile mosaic-"+t+"-tile").append(o()(n.mosaic.document.createElement("div")).addClass("mosaic-tile-content").attr("data-tileUrl",i&&i.replace(/&/gim,"&amp;")).html(a)).addClass("mosaic-helper-tile mosaic-helper-tile-new mosaic-original-tile")))),s=n.mosaic.panels.find(".mosaic-helper-tile-new"),r=0,n.mosaic.panels.each((function(){o()(this).width()>r&&(r=o()(this).width())})),s.width()<r/4?s.width(r/4):s.width(s.width()),l=new c.default(n.mosaic,s),e.next=10,l.initialize();case 10:l.cacheHtml(),l.scanRegistry();case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,a){return r.apply(this,arguments)})},{key:"getDefaultValue",value:function(e){var t,a;if("IDublinCore-title"===e.name?(t='<h1 class="documentFirstHeading">',a="</h1>"):"IDublinCore-description"===e.name?(t='<p class="documentDescription">',a="</p>"):(t="<div>",a="</div>"),"field"===e.tile_type)switch(e.widget){case"z3c.form.browser.text.TextWidget":case"z3c.form.browser.text.TextFieldWidget":return textval=o()("#"+e.id,this.mosaic.document).find("input").attr("value"),"".concat(t).concat(textval).concat(a);case"z3c.form.browser.textarea.TextAreaWidget":case"z3c.form.browser.textarea.TextAreaFieldWidget":case"z3c.form.browser.textlines.TextLinesWidget":case"z3c.form.browser.textlines.TextLinesFieldWidget":var i=o()("#"+e.id,this.mosaic.document).find("textarea").val().replace("\\n","<br/>");return"".concat(t).concat(i).concat(a);case"plone.app.z3cform.widget.RichTextFieldWidget":case"plone.app.z3cform.wysiwyg.widget.WysiwygWidget":case"plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget":case"plone.app.widgets.dx.RichTextWidget":return o()("#"+e.id).find("textarea").val();default:return'<div class="discreet">Placeholder for field:<br/><b>'+e.label+"</b></div>"}return e.default_value}},{key:"getPageContent",value:function(e){var t,a=this,i=function t(a){var i="";return!1===o()(a).hasClass("mosaic-empty-row")&&o()(a).find(".mosaic-tile").length>=0&&(s=o()(a).attr("class"),i+='      <div class="'+s+'">\n',o()(a).children(".mosaic-grid-cell").each((function(){i+='        <div class="'+o()(this).attr("class")+'">\n',o()(this).children().each((function(){o()(this).hasClass("mosaic-tile")?i+=o()(this).data("mosaic-tile").getHtmlBody(e):o()(this).hasClass("mosaic-innergrid-row")&&(i+=t(this))})),i+="        </div>\n"})),i+="      </div>\n"),i},n="",s="";return a.disableEditHtmlSource(),n+="  <body>\n",o()("[data-panel]",a.mosaic.document).each((function(){n+='    <div data-panel="'+o()(this).data("panel")+'"',n+='         data-max-columns="'+o()(this).data("max-columns")+'">\n',o()(this).children().each((function(){o()(this).hasClass("mosaic-grid-row")&&(n+=i(this))})),n+="    </div>\n"})),n+="  </body>\n",t='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" data-layout="'+a.mosaic.options.layout+'">\n',t+=n,t+="</html>\n"}},{key:"saveLayoutToForm",value:function(){var e=o()("#form-widgets-ILayoutAware-customContentLayout, [name='form.widgets.ILayoutAware.customContentLayout']");this.mosaic.hasContentLayout?e.val(""):e.val(this.getPageContent())}},{key:"init_events",value:function(){var e=this;o()(e.mosaic.document).off("keydown").on("keydown",(function(t){if(9===t.keyCode){var a,i=d(e.mosaic.document.querySelectorAll(".mosaic-selected-tile"));try{for(i.s();!(a=i.n()).done;)a.value["mosaic-tile"].blur()}catch(e){i.e(e)}finally{i.f()}var n=document.activeElement.closest(".mosaic-tile");n&&n["mosaic-tile"].focus()}if(18===t.keyCode)if(o()(".mosaic-panel",e.mosaic.document).hasClass("mosaic-advanced"))o()(".mosaic-panel",e.mosaic.document).removeClass("mosaic-advanced");else{var s=new Date;o()(".mosaic-panel",e.mosaic.document).addClass("mosaic-advanced"),o()(".mosaic-panel",e.mosaic.document).data("advanced-enabled",s.getTime())}if(17===t.keyCode&&o()(".mosaic-panel",e.mosaic.document).addClass("inner-subcolumn"),27===t.keyCode){var r=o()(".mosaic-original-tile",e.mosaic.document);r.length>0?r.each((function(){o()(this).addClass("mosaic-drag-cancel"),o()(this).hasClass("mosaic-helper-tile-new")?o()(document).trigger("mousedown"):o()(document).trigger("mouseup")})):o()(".mosaic-selected-tile",e.mosaic.document).each((function(){o()(this).trigger("blur")})),o()(".mosaic-resize-handle-helper",e.mosaic.document).each((function(){o()(this).parents("[data-panel]").removeClass("mosaic-panel-resizing"),o()(this).parent().removeClass("mosaic-row-resizing"),o()(this).parent().children(".mosaic-resize-placeholder").remove(),o()(this).remove()})),e.mosaic.overlay.app&&e.mosaic.overlay.app.hide()}})),o()(e.mosaic.document).off("keyup").on("keyup",(function(t){if(18===t.keyCode){var a=new Date,i=o()(".mosaic-panel",e.mosaic.document).data("advanced-enabled");a.getTime()-i>400&&o()(".mosaic-panel",e.mosaic.document).removeClass("mosaic-advanced")}17===t.keyCode&&o()(".mosaic-panel",e.mosaic.document).removeClass("inner-subcolumn"),o()(".mce-edit-focus").trigger("focus")})),o()(e.mosaic.document).off("mousedown").on("mousedown",(function(t){var a;if(v.info("Mousedown"),t.target?a=t.target:t.srcElement&&(a=t.srcElement),o()(a).parents(".mce-content-body, .tox-editor-container, .modal-wrapper").length>0)v.info(" - inside TinyMCE or Modal -> break");else{0===o()(a).parents(".mosaic-tile").length&&0===o()(a).parents(".mosaic-toolbar").length&&(o()(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").trigger("blur"),e.mosaic.toolbar.SelectedTileChange());var i=o()(".mosaic-helper-tile-new",e.mosaic.document);i.length>0&&i.each(f(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o()(this).mosaicHandleDragEnd();case 2:case"end":return e.stop()}}),e,this)}))))}}));var t=function(t){o()(".mosaic-helper-tile-new",e.mosaic.document).each((function(){var e=o()(this).parent().offset();o()(this).css("top",t.pageY+3-e.top),o()(this).css("left",t.pageX+3-e.left)})),o()(".mosaic-resize-handle-helper",e.mosaic.document).each((function(){var a;v.info("===================");var i=o()(this),n=i.parent(),s=i.data("resize_handle_index"),r=parseFloat(t.pageX-n.offset().left-4),c=Math.round(r/i.data("row_width")*100),l=8,d=8,m=w();o()(m).each((function(){(a=Math.abs(this-c))<d&&(l=this,d=a)}));var u=function(e){for(var t=w(),a=0;a<t.length;a++)if(e===t[a])return a+1;return 12}(l),h=[];n.children(".mosaic-resize-placeholder").each((function(){var e=b(o()(this).mosaicGetWidthClass());h.push(e)}));for(var f=0,p=0,g=0,y=0;y<h.length;y++)y<s&&(f+=h[y]?h[y]:2),y==s&&(p+=h[y]),y>s&&(g+=h[y]?h[y]:2);var z=u-f,x=12-f-g,E=f+(z=z>x?x:z<0?0:z);v.info("column_sizes",h),v.info("snap_size",u),v.info("col_size_before",f),v.info("col_size_after",g),v.info("col_size_max",x),v.info("col_size",z),v.info("col_size_this",p),v.info("col_size_handle",E),v.info("resize_handle_index",s),i.data("nr_of_columns")>1&&(n.children(".mosaic-resize-placeholder").each((function(t){if(t===s){h[t]=z;var a="mosaic-resize-0";if(h.length>1&&t>0){for(var i=0,n=0;n<t;n++)i+=h[n];a="mosaic-resize-"+i}var r=C(z);o()(this).removeClass(e.layout.widthClasses.join(" ")).removeClass(e.layout.dataClasses.join(" ")).removeClass(e.layout.positionClasses.join(" ").replace(/position/g,"resize")).addClass("mosaic-"+r+" "+r+" "+a).find(".info").html(z)}})),o()(this).data("column_sizes",h))}))};o()(e.mosaic.document).off("mousemove").on("mousemove",t),o()(e.mosaic.document).off("dragover").on("dragover",t),o()(e.mosaic.document).off("mouseup").on("mouseup",(function(){o()(".mosaic-resize-handle-helper",e.mosaic.document).each((function(){var t=o()(this).data("resize_handle_index");o()(this).parent().parent().mosaicCleanupRow();var a=o()(this).parents("[data-panel]"),i=o()(this).data("column_sizes");o()(this).parent().children(".mosaic-grid-cell").each((function(a){for(var n=0;n<a;n++)i[n];o()(this).removeClass(e.layout.positionClasses.join(" ")).removeClass(e.layout.widthClasses.join(" ")).addClass(C(i[a])),o()(this).hasClass("col")||a!==t||o()(this).children(".mosaic-tile").first().children(".mosaic-tile-side-tools").each((function(){var t=o()(this);t.children(".mosaic-tile-label.reset").remove(),t.append(o()(e.mosaic.document.createElement("div")).addClass("mosaic-tile-label reset").append(y(t,i[a])))}))})),a.removeClass("mosaic-panel-resizing"),o()(this).parent().removeClass("mosaic-row-resizing"),o()(this).parent().children(".mosaic-resize-placeholder").remove(),o()(this).parent().mosaicSetResizeHandles();var n=a.find(".mosaic-selected-tile");n.length>0&&n.data("mosaic-tile").select(),o()(this).remove()}))}));var a=function(t){if(o()(this).parents("[data-panel]").hasClass("mosaic-panel-dragging")&&(o()(".mosaic-selected-divider",e.mosaic.document).removeClass("mosaic-selected-divider"),!1===o()(this).hasClass("mosaic-original-tile")&&!1===o()(this).hasClass("mosaic-tile-align-left")&&!1===o()(this).hasClass("mosaic-tile-align-right"))){var a=o()(this).mosaicGetDirection(t),i=o()(this).children(".mosaic-divider-"+a);if("left"===a||"right"===a){var n=i.parent().parent().parent();if(n.children(".mosaic-grid-cell").length>=o()(".mosaic-panel").data("max-columns"))return;n.children(".mosaic-grid-cell").length>1?(i.height(n.height()+5),i.css("top",n.offset().top-i.parent().offset().top-5)):(i.height(i.parent().height()+5),i.css("top",-5))}i.addClass("mosaic-selected-divider")}};o()(e.mosaic.document).off("mousemove",".mosaic-tile").on("mousemove",".mosaic-tile",a),o()(e.mosaic.document).off("dragover",".mosaic-tile").on("dragover",".mosaic-tile",a),o()(e.mosaic.document).off("click",".mosaic-tile").on("click",".mosaic-tile",(function(){0===o()(".mosaic-helper-tile-new",e.mosaic.document).length&&o()(this).data("mosaic-tile").select()})),o()(e.mosaic.document).on("dblclick",".mosaic-grid-row",(function(e){var t=o()(e.target);if(t.parents("[data-panel]").hasClass("mosaic-advanced")&&t.hasClass("mosaic-grid-row")){if(o()(t).find(".mosaic-set-custom-css").length>0)return;var a=[];o().each(t.attr("class").split(" "),(function(){void 0!==this&&"mosaic-grid-row"!==this&&"mosaic-innergrid-row"!==this&&a.push(this)}));var i=o()("<input type='text' id='custom-css-input-box'></input>").val(a.join(" ")),n=o()("<div></div>").addClass("mosaic-set-custom-css").append(o()("<label>Custom CSS for this row:</label>")).append(i);t.append(n)}})),o()(e.mosaic.document).on("click",(function(e){"custom-css-input-box"!==o()(e.target).attr("id")&&o().each(o()("div.mosaic-set-custom-css"),(function(){var e=o()(this).parent(),t="mosaic-grid-row";e.hasClass("mosaic-innergrid-row")&&(t="mosaic-grid-row mosaic-innergrid-row"),t+=" "+o()(this).find("input#custom-css-input-box").val(),e.attr("class",t),o()(this).remove()}))}))}},{key:"initialize_panels",value:(n=f(u().mark((function e(){var t,a,i,n,r,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for((t=this).initJQueryHelpers(),t.init_events(),a=t.mosaic.panels.length,i=0;i<a;i++)(n=o()(t.mosaic.panels[i])).find(".mosaic-tile").each(f(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:new c.default(t.mosaic,this).initialize();case 2:case"end":return e.stop()}}),e,this)})))),n.find(".mosaic-tile").mosaicAddDrag(),n.mosaicAddEmptyRows(),n.children(".mosaic-grid-row").mosaicSetResizeHandles(),i===a-1&&(r=0,l=0,t.mosaic.panels.each((function(e){o()(this).width()>r&&(r=o()(this).width(),l=e)})),(d=t.mosaic.panels.eq(l).find(".mosaic-tile:first")).length>0&&d.data("mosaic-tile").select()),n.find(".mosaic-innergrid-row").each((function(){o()(this).mosaicAddMouseMoveInnergridRow(),o()(this).mosaicSetResizeHandles();var e=o()(this);s().each(["top","bottom"],(function(a){e.append(o()(t.mosaic.document.createElement("div")).addClass("mosaic-divider mosaic-divider-"+a).append(o()(t.mosaic.document.createElement("div")).addClass("mosaic-divider-dot")))}))}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"initJQueryHelpers",value:function(){var e=this,t=e.mosaic.document;o().fn.mosaicAddMouseMoveEmptyRow=function(){return this.each((function(){o()(this).on("mousemove",(function(){o()(this).parents("[data-panel]").hasClass("mosaic-panel-dragging")&&(o()(".mosaic-selected-divider",t).removeClass("mosaic-selected-divider"),o()(this).children("div").addClass("mosaic-selected-divider"))}))}))},o().fn.mosaicAddMouseMoveInnergridRow=function(){return this.each((function(){o()(this).mousemove((function(e){if(o()(this).parents("[data-panel]").hasClass("mosaic-panel-dragging")){o()(".mosaic-selected-divider",t).removeClass("mosaic-selected-divider");var a=o()(this).mosaicGetDirection(e);o()(this).children(".mosaic-divider-"+a).addClass("mosaic-selected-divider")}}))}))},o().fn.mosaicAddEmptyRows=function(){return this.each((function(){o()(this).find(".mosaic-grid-row:not(.mosaic-innergrid-row)").each((function(){o()(this).before(o()(t.createElement("div")).addClass("mosaic-grid-row mosaic-empty-row").append(o()(t.createElement("div")).addClass("mosaic-grid-cell col").append(o()(t.createElement("div")).append(o()(t.createElement("div")).addClass("mosaic-tile-outer-border").append(o()(t.createElement("div")).addClass("mosaic-divider-dot"))))).mosaicAddMouseMoveEmptyRow()),0===o()(this).nextAll(".mosaic-grid-row").length&&o()(this).after(o()(t.createElement("div")).addClass("mosaic-grid-row mosaic-empty-row").append(o()(t.createElement("div")).addClass("mosaic-grid-cell col").append(o()(t.createElement("div")).append(o()(t.createElement("div")).addClass("mosaic-tile-outer-border").append(o()(t.createElement("div")).addClass("mosaic-divider-dot"))))).mosaicAddMouseMoveEmptyRow())})),0===o()(this).find(".mosaic-grid-row:not(.mosaic-innergrid-row)").length&&o()(this).append(o()(t.createElement("div")).addClass("mosaic-grid-row mosaic-empty-row").append(o()(t.createElement("div")).addClass("mosaic-grid-cell col").append(o()(t.createElement("div")).append(o()(t.createElement("div")).addClass("mosaic-tile-outer-border").append(o()(t.createElement("div")).addClass("mosaic-divider-dot"))))).mosaicAddMouseMoveEmptyRow())}))},o().fn.mosaicGetDataClass=function(){var t,a=d(e.layout.dataClasses);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(o()(this).hasClass(i))return i}}catch(e){a.e(e)}finally{a.f()}return e.layout.dataClasses[0]},o().fn.mosaicGetWidthClass=function(){var t,a=d(e.layout.widthClasses);try{for(a.s();!(t=a.n()).done;){var i=t.value,n=i,s=i.replace("position","resize");if(o()(this).hasClass(n)||o()(this.hasClass(s)))return i}}catch(e){a.e(e)}finally{a.f()}return e.layout.widthClasses[0]},o().fn.mosaicGetPositionClass=function(){var t,a=d(e.layout.positionClasses);try{for(a.s();!(t=a.n()).done;){var i=t.value,n=i,s=i.replace("position","resize");if(o()(this).hasClass(n)||o()(this.hasClass(s)))return i}}catch(e){a.e(e)}finally{a.f()}return e.layout.positionClasses[0]},o().fn.mosaicGetResizeHandleClassId=function(){for(var t=0;t<e.layout.resizeHandleClasses.length;t++)if(o()(this).hasClass(e.layout.resizeHandleClasses[t]))return t;return 1},o().fn.mosaicAddDrag=function(){return this.each((function(){var a=o()(this),i=function(e){var a=o()(".mosaic-helper-tile",t),i=a.parents("[data-panel]").offset();a.css("top",e.pageY+3-i.top),a.css("left",e.pageX+3-i.left)},n=function e(){var a=o()(".mosaic-helper-tile",t);o()(t).off("mousemove",i).off("mouseup",e),a.mosaicHandleDragEnd(),a.remove()};return a.each((function(){a.find("div.mosaic-drag-handle").off("mousedown").on("mousedown",(function(a){var s=a.pageX,r=a.pageY,c=function a(c){if(Math.max(Math.abs(s-c.pageX),Math.abs(r-c.pageY))>=1){e.mosaic.panels.addClass("mosaic-panel-dragging"),o()(".mosaic-selected-tile",t).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").trigger("blur");var l=o()(c.target).parents(".mosaic-tile");l.addClass("mosaic-original-tile");var d=l.clone(!0);d.css({width:l.width(),"max-height":"50%",position:"absolute",opacity:.5}).addClass("mosaic-helper-tile"),l.parents("[data-panel]").append(d),o()(t).on("mousemove",i),o()(t).on("mouseup",n),o()(t).off("mousemove",a)}};o()(t).on("mousemove",c),o()(t).on("mouseup",(function(){o()(t).off("mousemove",c)}))}))}))}))},o().fn.mosaicHandleDragEnd=f(u().mark((function a(){var i,n,s,r,c,l,d,m,h,f,p,g,y,w,C,b,z,x;return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:for(i=o()(this).parents("[data-panel]"),e.mosaic.panels.removeClass("mosaic-panel-dragging mosaic-panel-dragging-new"),n=o()(".mosaic-selected-divider",t),s=n.parent(),r="",c=0,l=["top","bottom","left","right"];c<l.length;c++)d=l[c],n.hasClass("mosaic-divider-"+d)&&(r=d);if(n.removeClass("mosaic-selected-divider"),m=o()(".mosaic-helper-tile-new",t).length>0,h=o()(".mosaic-original-tile",t),f=h.closest(".mosaic-grid-row"),(0===n.length||s.hasClass("mosaic-helper-tile"))&&h.addClass("mosaic-drag-cancel"),p=function(e){e.removeClass("mosaic-drag-cancel"),e.removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left"),e.css({width:"",left:"",top:""}),m||e.addClass("mosaic-new-tile")},h.hasClass("mosaic-drag-cancel")||!1===s.hasClass("mosaic-tile")&&!1===s.hasClass("mosaic-innergrid-row")&&!1===s.hasClass("mosaic-empty-row")||s.parent().parent().children(".mosaic-grid-cell").length>=i.data("max-columns")&&("left"===r||"right"===r))p(h);else if(s.hasClass("mosaic-empty-row"))s.removeClass("mosaic-empty-row").attr("class",h.parents(".mosaic-grid-row").first().attr("class")).off("mousemove"),s.children(".mosaic-grid-cell").children("div").remove(),p(h),s.children(".mosaic-grid-cell").append(h);else{if(p(h),i.hasClass("inner-subcolumn"))for(h=o()(t.createElement("div")).addClass("mosaic-grid-row mosaic-innergrid-row").append(o()(t.createElement("div")).addClass("mosaic-grid-cell col").append(o()(t.createElement("div")).append(o()(t.createElement("div")).addClass("mosaic-innergrid-outer-border"))).append(h)).mosaicAddMouseMoveInnergridRow(),g=0,y=["top","bottom"];g<y.length;g++)w=y[g],h.append(o()(t.createElement("div")).addClass("mosaic-divider mosaic-divider-"+w).append(o()(t.createElement("div")).addClass("mosaic-divider-dot")));"top"===r?s.before(h):"bottom"===r?s.after(h):"left"!==r&&"right"!==r||(C=s.parent(),1===(b=C.parent()).children(".mosaic-grid-cell").length.length?((z=s.prevAll()).length>0&&(b.before(o()(t.createElement("div")).addClass("mosaic-grid-row").append(o()(t.createElement("div")).addClass("mosaic-grid-cell col").append(o()(z.get().reverse()).clone(!0).mosaicAddDrag()))),z.remove()),(x=s.nextAll()).length>0&&(b.after(o()(t.createElement("div")).addClass("mosaic-grid-row").append(o()(t.createElement("div")).addClass("mosaic-grid-cell col").append(x.clone(!0).mosaicAddDrag()))),x.remove()),C.removeClass(e.layout.widthClasses.join(" ")).removeClass(e.layout.positionClasses.join(" ")).addClass("col"),v.info("Now inside here left right"),"left"===r?s.parent().before(o()(t.createElement("div")).addClass("mosaic-grid-cell col").append(h)):s.parent().after(o()(t.createElement("div")).addClass("mosaic-grid-cell col").append(h)),b.mosaicSetResizeHandles()):("left"===r?C.before(o()(t.createElement("div")).addClass("mosaic-grid-cell").append(h)):C.after(o()(t.createElement("div")).addClass("mosaic-grid-cell").append(h)),b.mosaicSetColumnSizes(),b.mosaicSetResizeHandles()))}e.mosaic.panels.find(".mosaic-grid-row:not(:has(.mosaic-tile))").remove(),e.mosaic.panels.find(".mosaic-empty-row").remove(),f.mosaicCleanupRow(),e.mosaic.panels.mosaicAddEmptyRows(),m&&(h.data("mosaic-tile").initializeContent(),h.data("mosaic-tile").focus());case 19:case"end":return a.stop()}}),a,this)}))),o().fn.mosaicSetColumnSizes=function(){return this.each((function(){var t=[],a=o()(this).children(".mosaic-grid-cell").length;o()(this).children(".mosaic-grid-cell").each((function(i){o()(this).removeClass(e.layout.widthClasses.join(" ")).removeClass(e.layout.positionClasses.join(" "));var n=0,s=Math.floor(12/a),r=12-s*(a-1);v.info("------"),v.info("position",n),v.info("col_size",s),v.info("col_size_last",r),v.info("nr_of_columns",a),v.info("------");for(var c=0;c<a;c++)c>0&&(n+=s),c===a-1&&(s=r),i===c&&(t.push(s),o()(this).addClass("col"))})),o()(this).data("column_sizes",t)}))},o().fn.mosaicSetResizeHandles=function(){return this.each((function(){o()(this).children(".mosaic-resize-handle").remove();var e=o()(this).children(".mosaic-grid-cell").length;if(e>1&&e<=12){v.info("nr_of_columns > 1 && nr_of_columns <= 12");for(var a=[],i=0,n=0,s=0;s<e;s++){var r=b(o()(o()(this).children(".mosaic-grid-cell").get(s)).mosaicGetWidthClass());a.push(r),n+=r,0===r&&(i+=1)}var c=0;i&&(c=(12-n)/i);var l=0,d=0;r=0;for(var m=0;m<e;m++)l+=r=a[m]?a[m]:c,d=Math.round(l/12*1e4)/100,v.info("resize_col_size",l),o()(this).append(o()(t.createElement("div")).addClass("mosaic-resize-handle mosaic-resize-handle-"+(m+1)+" mosaic-resize-"+l).data("resize_handle_index",m).css({marginLeft:d+"%"}));v.info("$.fn.mosaicSetResizeHandles"),v.info("column_sizes",a),v.info("zero_count",i),v.info("col_size",r)}o()(this).children(".mosaic-resize-handle").mousedown((function(){var e=o()(this).parent().children(".mosaic-grid-cell"),a=e.length,i=[];if(a>1&&a<=12)for(var n=0;n<a;n++){var s=b(o()(e.get(n)).mosaicGetWidthClass());i.push(s)}e.each((function(e){var a=o()(this).mosaicGetWidthClass(),n=a.replace("col","mosaic-col"),s=b(a);0==s&&(s="0 (2)");var r="mosaic-resize-0";if(i.length>1&&e>0){for(var c=0,l=0;l<e;l++)c+=i[l];r="mosaic-resize-"+c}o()(this).parent().append(o()(t.createElement("div")).addClass("mosaic-resize-placeholder "+a+" "+n+" "+r).append(o()(t.createElement("div")).addClass("mosaic-resize-placeholder-inner-border").append(o()(t.createElement("div")).addClass("info").html(s))))}));var r=o()(this).mosaicGetResizeHandleClassId();return o()(this).parent().append(o()(t.createElement("div")).addClass("mosaic-resize-handle mosaic-resize-handle-helper").addClass(o()(this).mosaicGetPositionClass().replace("position","resize")).data("row_width",o()(this).parent().width()).data("nr_of_columns",a).data("column_sizes",i).data("resize_handle_index",r)),o()(this).parents("[data-panel]").addClass("mosaic-panel-resizing"),o()(this).parent().addClass("mosaic-row-resizing"),o()(".mosaic-selected-tile",t).children(".mosaic-tile-content").trigger("blur"),!1}))}))},o().fn.mosaicCleanupRow=function(){return this.each((function(){var e=o()(this);if(e.children(".mosaic-grid-cell").each((function(){0===o()(this).children().length&&(o()(this).remove(),e.mosaicSetColumnSizes())})),0===e.find(".mosaic-tile").length){var t=e;if(e.nextAll(".mosaic-grid-row").length>0)e=e.next(".mosaic-grid-row");else{if(!(e.prevAll(".mosaic-grid-row").length>0))return void e.remove();e=e.prev(".mosaic-grid-row")}t.remove()}e.mosaicSetResizeHandles()}))},o().fn.mosaicGetDirection=function(e){var t=parseFloat(o()(this).width()),a=parseFloat(o()(this).height()),i=parseFloat(e.pageX-o()(this).offset().left-t/2),n=parseFloat(e.pageY-o()(this).offset().top-a/2),s=t/2,r=a/2;return i<0?n<0?i/n<-1*s/(-1*r)?"top":"left":i/n<-1*s/r?"left":"bottom":n<0?i/n<1*s/(-1*r)?"right":"top":i/n<s/r?"bottom":"right"}}}],a&&p(t.prototype,a),i&&p(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}(),y=function(e,t){var a=document.createElement("a"),i=void 0===t?"":" ("+t+")";return a.href="javascript:",a.textContent="Reset"+i,o()(a).on("click",{el:e},(function(e){e.preventDefault(),e.data.el.parent().parent().removeClass("col-1 col-2 col-3 col-4 col-5 col-6 col-7 col-8 col-9 col-10 col-11 col-12").addClass("col"),e.data.el.parent().parent().parent().mosaicSetResizeHandles(),o()(e.target).parent().parent().remove()})),a};function w(){for(var e=[],t=0;t<99;)e.push(Math.round(t+=8.333333333333334));return e}function C(e){return e?"col-"+e:"col"}function b(e,t){t=t||"col-";for(var a=0;a<12;a++)if(e===t+(a+1))return a+1;return 0}}}]);
//# sourceMappingURL=60185.a91de9f4efd71189ecfc.min.js.map