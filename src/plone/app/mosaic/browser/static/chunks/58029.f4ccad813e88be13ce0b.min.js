"use strict";(self.webpackChunkplone_mosaic=self.webpackChunkplone_mosaic||[]).push([[58029],{24283:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});n(35666);var i=n(99269),a=n.n(i),o=n(98860),l=n(81421),s=n(10354),r=n(62832),c=n(76389);function p(e,t,n,i,a,o,l){try{var s=e[o](l),r=s.value}catch(e){return void n(e)}s.done?t(r):Promise.resolve(r).then(i,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function l(e){p(o,i,a,l,s,"next",e)}function s(e){p(o,i,a,l,s,"throw",e)}l(void 0)}))}}var u,m,h=l.Z.extend({name:"select2",trigger:".pat-select2",parser:"mockup",defaults:{separator:","},initializeValues:function(){var e=this;e.options.initialValues&&(e.options.id=function(e){return e.id},e.options.initSelection=function(t,n){var i=[],o=t.val(),l=e.options.initialValues;"string"==typeof e.options.initialValues&&""!==e.options.initialValues&&("{"===e.options.initialValues[0]?l=JSON.parse(e.options.initialValues):(l={},a()(e.options.initialValues.split(e.options.separator)).each((function(){var e=this.split(":"),t=a().trim(e[0]),n=a().trim(e[1]);l[t]=n})))),a()(o.split(e.options.separator)).each((function(){var e=this;l[this]&&(e=l[this]),i.push({id:r.Z.removeHTML(this),text:r.Z.removeHTML(e)})})),n(i)})},initializeTags:function(){var e=this;e.options.tags&&"string"==typeof e.options.tags&&("["===e.options.tags.substr(0,1)?e.options.tags=JSON.parse(e.options.tags):e.options.tags=e.options.tags.split(e.options.separator)),e.options.tags&&!e.options.allowNewItems&&(e.options.data=a().map(e.options.tags,(function(e,t){return{id:e,text:e}})),e.options.multiple=!0,delete e.options.tags)},initializeOrdering:function(){var e=this;this.options.orderable&&this.$el.on("change",d(regeneratorRuntime.mark((function t(){var i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(51474).then(n.bind(n,51474));case 2:i=(i=t.sent).default,a=e.$select2[0].querySelector(".select2-choices"),new i(a,{draggable:"li",dragClass:"select2-choice-dragging",chosenClass:"dragging",onStart:function(){return e.$el.select2("onSortStart")},onEnd:function(){return e.$el.select2("onSortEnd")}});case 6:case"end":return t.stop()}}),t)}))))},initializeSelect2:(m=d(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(e,n){return e?(t.options.debug&&console.debug("callback",e,n),"string"==typeof e&&(e=window[e]),e(n)):e},Promise.all([n.e(14894),n.e(69106)]).then(n.bind(n,630)),n.e(89429).then(n.bind(n,89429)),e.next=5,n.e(14299).then(n.t.bind(n,14299,23));case 5:(t=this).options.formatResultCssClass=function(e){if(e.id)return"select2-option-"+e.id.toLowerCase().replace(/[ \:\)\(\[\]\{\}\_\+\=\&\*\%\#]/g,"-")},a()(t.el).select2(t.options),t.$el.on("select2-selected",(function(e){i(t.options.onSelected,e)})),t.$el.on("select2-selecting",(function(e){i(t.options.onSelecting,e)})),t.$el.on("select2-deselecting",(function(e){i(t.options.onDeselecting,e)})),t.$el.on("select2-deselected",(function(e){i(t.options.onDeselected,e)})),t.$select2=t.$el.parent().find(".select2-container"),t.$el.parent().off("close.plone-modal.patterns"),t.options.orderable&&t.$select2.addClass("select2-orderable");case 15:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)}),opened:function(){return 1===a()(".select2-dropdown-open",this.$el.parent()).length},init:(u=d(regeneratorRuntime.mark((function e(){var t,n,i,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this).options.allowNewItems=!t.options.hasOwnProperty("allowNewItems")||JSON.parse(t.options.allowNewItems),t.options.ajax||t.options.vocabularyUrl?(t.options.vocabularyUrl&&(t.options.multiple=void 0===t.options.multiple||t.options.multiple,t.options.ajax=t.options.ajax||{},t.options.ajax.url=t.options.vocabularyUrl,t.options.initSelection=function(e,n){var i=[],o=e.val();a()(o.split(t.options.separator)).each((function(){var e=r.Z.removeHTML(this);i.push({id:e,text:e})})),n(i)}),n="",t.options.ajax=a().extend({quietMillis:300,data:function(e,t){return n=e,{query:e,page_limit:10,page:t}},results:function(e,i){var o=e.results;if(t.options.vocabularyUrl){var l=[];a().each(e.results,(function(e,t){l.push(t.id)})),o=[];var s=""===n||a().inArray(n,l)>=0;t.options.allowNewItems&&!s&&(n=r.Z.removeHTML(n),o.push({id:n,text:n})),a().each(e.results,(function(e,t){o.push(t)}))}return{results:o}}},t.options.ajax)):t.options.multiple&&t.$el.is("select")&&(i=t.$el.val()||[],o=a().map(t.$el.find("option"),(function(e){return{text:a()(e).html(),id:e.value}})),(l=a()('<input type="hidden" />')).val(i.join(t.options.separator)),l.attr("class",t.$el.attr("class")),l.attr("name",t.$el.attr("name")),l.attr("id",t.$el.attr("id")),t.$orig=t.$el,t.$el.replaceWith(l),t.$el=l,t.options.data=o),t.initializeValues(),t.initializeTags(),t.initializeOrdering(),e.next=8,t.initializeSelect2();case 8:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})});function f(e,t,n,i,a,o,l){try{var s=e[o](l),r=s.value}catch(e){return void n(e)}s.done?t(r):Promise.resolve(r).then(i,a)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function l(e){f(o,i,a,l,s,"next",e)}function s(e){f(o,i,a,l,s,"throw",e)}l(void 0)}))}}var v,y=37,b=39,x=l.Z.extend({name:"relateditems",trigger:".pat-relateditems",parser:"mockup",currentPath:void 0,selectedUIDs:[],openAfterInit:void 0,defaults:{vocabularyUrl:null,attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],basePath:"",pageSize:10,browsing:void 0,closeOnSelect:!0,contextPath:void 0,dropdownCssClass:"pat-relateditems-dropdown",favorites:[],recentlyUsed:!1,recentlyUsedMaxItems:20,recentlyUsedKey:"relateditems_recentlyused",maximumSelectionSize:-1,minimumInputLength:0,mode:"browse",orderable:!0,pathOperator:"plone.app.querystring.operation.string.path",rootPath:"/",rootUrl:"",scanSelection:!1,selectableTypes:null,separator:",",sortOn:null,sortOrder:"ascending",tokenSeparators:[","," "],upload:!1,uploadAllowView:void 0,breadcrumbTemplateSelector:null,favoriteTemplateSelector:null,recentlyusedTemplateSelector:null,resultTemplateSelector:null,selectionTemplateSelector:null,toolbarTemplateSelector:null,multiple:!0},recentlyUsed:function(e){var t=r.Z.storage.get(this.options.recentlyUsedKey)||[];t=t.slice(t.length-1e3,t.length),e&&t.filter(this.isSelectable.bind(this));var n=parseInt(this.options.recentlyUsedMaxItems,10);return n&&(t=t.slice(t.length-n,t.length)),t},applyTemplate:function(e,t){var n,i=this;i.options[e+"TemplateSelector"]&&(n=a()(i.options[e+"TemplateSelector"]).html())||(n=i[e+"Template"]);var l=a().extend(!0,{},i.options,t,{browsing:i.browsing,open_folder:(0,s.Z)("Open folder"),current_directory:(0,s.Z)("current directory:"),one_level_up:(0,s.Z)("Go one level up")});return l._item=t,o.ZP.template(n)(l)},setAjax:function(){var e={url:this.options.vocabularyUrl,dataType:"JSON",quietMillis:500,data:function(e,t){var n=[];e&&(e="*"+e+"*",n.push({i:"SearchableText",o:"plone.app.querystring.operation.string.contains",v:e})),!this.browsing&&this.options.selectableTypes&&n.push({i:"portal_type",o:"plone.app.querystring.operation.selection.any",v:this.options.selectableTypes}),n.push({i:"path",o:this.options.pathOperator,v:this.options.rootPath+this.currentPath+(this.browsing?"::1":"")});var i=this.options.sortOn,a=i?this.options.sortOrder:null;return this.browsing&&null===i&&(i="getObjPositionInParent",a="ascending"),{query:JSON.stringify({criteria:n,sort_on:i,sort_order:a}),attributes:JSON.stringify(this.options.attributes),batch:JSON.stringify({page:t||1,size:this.options.pageSize})}}.bind(this),results:function(e,t){var n=t*this.options.pageSize<e.total,i=e.results;this.selectedUIDs=(a()(this.el).select2("data")||[]).map((function(e){return e.UID})),i=i.filter(function(e){return!!(this.browsing&&e.is_folderish||this.isSelectable(e)&&-1===this.selectedUIDs.indexOf(e.UID))}.bind(this));var o=this.currentPath.split("/");return 1===t&&this.browsing&&o.length>1&&"/"!==this.currentPath&&(i=[{oneLevelUp:!0,Title:(0,s.Z)("One level up"),path:o.slice(0,o.length-1).join("/")||"/",currentPath:this.currentPath,is_folderish:!0,selectable:!1}].concat(i)),{results:i,more:n}}.bind(this)};this.options.ajax=e},renderToolbar:(v=g(regeneratorRuntime.mark((function e(){var t,i,l,c,p,d,u,m,h,f,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v=function(){return(v=g(regeneratorRuntime.mark((function e(i){var o,l,s,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,37103));case 2:o=(o=e.sent).default,(l=t.$toolbar[0].querySelector(".upload button")).disabled=i,s=t.$toolbar[0].querySelector(".upload .pat-upload"),c={success:function(e,n){var i=n.UID;i&&new r.Z.QueryHelper({vocabularyUrl:t.options.vocabularyUrl,attributes:t.options.attributes}).search("UID","plone.app.querystring.operation.selection.is",i,(function(e){var n=t.$el.select2("data");n.push.apply(n,e.results),t.$el.select2("data",n,!0),t.emit("selected"),t.popover.hide()}),!1)},uloadMultiple:!0,allowPathSelection:!1,relativePath:"fileUpload",baseUrl:t.options.rootUrl},p=new o(a()(s),c),l.addEventListener("show.bs.dropdown",(function(){t.currentPath!==p.currentPath&&p.setPath(t.currentPath)}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)},f=function(e){return v.apply(this,arguments)},i=(t=this).currentPath,c=i.split("/"),p="",d="",o.ZP.each(c,(function(e){if(""!==e){var n={};n.path=p=p+"/"+e,n.text=e,d+=t.applyTemplate("breadcrumb",n)}})),u="",o.ZP.each(t.options.favorites,(function(e){var n=o.ZP.clone(e);n.path=n.path.substr(t.options.rootPath.length)||"/",u+=t.applyTemplate("favorite",n)})),m="",t.options.recentlyUsed&&(h=t.recentlyUsed(!0),o.ZP.each(h.reverse(),(function(e){m+=t.applyTemplate("recentlyused",e)}))),e.t0=t,e.t1=d,e.t2=u,e.t3=(0,s.Z)("Favorites"),e.t4=(0,s.Z)("Current path:"),e.t5=(0,s.Z)("Search"),e.t6=(0,s.Z)("Browse"),e.t7=m,e.t8=(0,s.Z)("Recently Used"),e.next=23,r.Z.resolveIcon("house-fill");case 23:return e.t9=e.sent,e.next=26,r.Z.resolveIcon("grid-fill");case 26:return e.t10=e.sent,e.next=29,r.Z.resolveIcon("star-fill");case 29:return e.t11=e.sent,e.next=32,r.Z.resolveIcon("cloud-arrow-up");case 32:e.t12=e.sent,e.t13=this.options.upload,e.t14=(0,s.Z)("Upload"),e.t15={items:e.t1,favItems:e.t2,favText:e.t3,searchText:e.t4,searchModeText:e.t5,browseModeText:e.t6,recentlyUsedItems:e.t7,recentlyUsedText:e.t8,icon_root:e.t9,icon_recently_used:e.t10,icon_favorites:e.t11,icon_upload:e.t12,upload:e.t13,upload_text:e.t14},l=e.t0.applyTemplate.call(e.t0,"toolbar",e.t15),t.$toolbar.html(l),a()(".pat-relateditems-dropdown").unbind("mouseup"),a()(".pat-relateditems-dropdown").bind("mouseup",(function(e){e.stopPropagation()})),a()("button.mode.search",t.$toolbar).on("click",(function(e){e.preventDefault(),t.browsing?(a()("button.mode.search",t.$toolbar).toggleClass("btn-primary btn-default"),a()("button.mode.browse",t.$toolbar).toggleClass("btn-primary btn-default"),t.browsing=!1,a()(t.el).select2("data").length>0&&(t.openAfterInit=!0),t.openAfterInit||(a()(t.el).select2("close"),a()(t.el).select2("open"))):(a()(t.el).select2("close"),a()(t.el).select2("open"))})),a()("button.mode.browse",t.$toolbar).on("click",(function(e){e.preventDefault(),t.browsing?(a()(t.el).select2("close"),a()(t.el).select2("open")):(a()("button.mode.search",t.$toolbar).toggleClass("btn-primary btn-default"),a()("button.mode.browse",t.$toolbar).toggleClass("btn-primary btn-default"),t.browsing=!0,a()(t.el).select2("data").length>0&&(t.openAfterInit=!0),t.openAfterInit||(a()(t.el).select2("close"),a()(t.el).select2("open")))})),a()("a.crumb",t.$toolbar).on("click",(function(e){e.preventDefault(),t.browseTo(a()(this).attr("href"))})),a()("a.fav",t.$toolbar).on("click",(function(e){e.preventDefault(),t.browseTo(a()(this).attr("href"))})),t.options.recentlyUsed&&a()(".pat-relateditems-recentlyused-select",t.$toolbar).on("click",(function(e){e.preventDefault();var n=a()(this).data("uid"),i=t.recentlyUsed().filter((function(e){return e.UID===n}));i.length>0&&(i=i[0],t.selectItem(i),t.options.maximumSelectionSize>0&&(a()(t.el).select2("data").length,t.options.maximumSelectionSize))})),t.options.upload&&r.Z.featureSupport.dragAndDrop()&&r.Z.featureSupport.fileApi()&&(t.options.uploadAllowView?a().ajax({url:t.options.uploadAllowView,dataType:"JSON",data:{path:t.options.rootPath+t.currentPath},type:"GET",success:function(e){f(!e.allowUpload)}}):f());case 46:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)}),browseTo:function(e){var t=this;t.emit("before-browse"),t.currentPath=e,a()(t.el).select2("close"),t.renderToolbar(),a()(t.el).select2("open"),t.emit("after-browse")},selectItem:function(e){var t=this;t.emit("selecting");var n=a()(t.el).select2("data");if(n.push(e),a()(t.el).select2("data",n,!0),t.options.recentlyUsed){var i=t.recentlyUsed(),o=i.filter((function(t){return t.UID===e.UID}));o.length>0&&i.splice(i.indexOf(o[0]),1),i.push(e),r.Z.storage.set(t.options.recentlyUsedKey,i)}t.emit("selected")},deselectItem:function(e){var t=this;t.emit("deselecting");var n=a()(t.el).select2("data");o.ZP.each(n,(function(t,i){t.UID===e.UID&&n.splice(i,1)})),a()(t.el).select2("data",n,!0),t.emit("deselected")},isSelectable:function(e){return!1!==e.selectable&&(null===this.options.selectableTypes||-1!==this.options.selectableTypes.indexOf(e.portal_type))},init:function(){var e=g(regeneratorRuntime.mark((function e(){var t,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(85169).then(n.bind(n,85169));case 2:return e.sent.Dropdown,n.e(24099).then(n.bind(n,24099)),e.next=6,n.e(8147).then(n.t.bind(n,8147,17));case 6:return this.breadcrumbTemplate=e.sent.default,e.next=9,n.e(58640).then(n.t.bind(n,58640,17));case 9:return this.favoriteTemplate=e.sent.default,e.next=12,n.e(77427).then(n.t.bind(n,77427,17));case 12:return this.recentlyusedTemplate=e.sent.default,e.next=15,n.e(71531).then(n.t.bind(n,71531,17));case 15:return this.resultTemplate=e.sent.default,e.next=18,n.e(8443).then(n.t.bind(n,8443,17));case 18:return this.selectionTemplate=e.sent.default,e.next=21,n.e(16071).then(n.t.bind(n,16071,17));case 21:return this.toolbarTemplate=e.sent.default,(t=this).browsing="search"!==t.options.mode,t.options.rootPath=t.options.rootPath.replace(/\/$/,""),t.currentPath=t.options.basePath.substr(t.options.rootPath.length)||"/",t.setAjax(),t.$el.wrap('<div class="pat-relateditems-container" />'),t.$container=t.$el.parents(".pat-relateditems-container"),h.prototype.initializeValues.call(t),h.prototype.initializeTags.call(t),t.options.formatSelection=function(e){e=a().extend(!0,{Title:"",getIcon:"",getURL:"",path:"",portal_type:"",review_state:""},e);var n=a()(t.applyTemplate("selection",e));if(t.options.scanSelection&&c.Z.scan(n),1==t.options.maximumSelectionSize){var i=e.path,o=i.split("/");i=(o=o.slice(0,-1)).join("/"),t.currentPath=i,t.renderToolbar()}return n},h.prototype.initializeOrdering.call(t),e.next=35,r.Z.resolveIcon("arrow-left-circle");case 35:return i=e.sent,e.next=38,r.Z.resolveIcon("arrow-right-circle");case 38:o=e.sent,t.options.formatResult=function(e){e.selectable=t.isSelectable(e),e=a().extend(!0,{Title:"",getIcon:"",getURL:"",is_folderish:!1,oneLevelUp:!1,iconLevelUp:i,iconLevelDown:o,path:"",portal_type:"",review_state:"",selectable:!1},e),-1!==t.selectedUIDs.indexOf(e.UID)&&(e.selectable=!1);var n=a()(t.applyTemplate("result",e));return a()(".pat-relateditems-result-select",n).on("click",(function(n){if(n.preventDefault(),a()(this).is(".selectable")){var i=a()(this).parents(".pat-relateditems-result");if(i.is(".pat-relateditems-active"))i.removeClass("pat-relateditems-active"),t.deselectItem(e);else{if(t.options.maximumSelectionSize>0)a()(t.el).select2("data").length>=t.options.maximumSelectionSize&&a()(t.el).select2("close");t.selectItem(e),i.addClass("pat-relateditems-active"),t.options.closeOnSelect&&a()(t.el).select2("close")}}})),a()(".pat-relateditems-result-browse",n).on("click",(function(e){e.preventDefault(),e.stopPropagation();var n=a()(this).data("path");t.browseTo(n)})),a()(n)},t.options.initSelection=function(e,n){var i=a()(e).val();if(""!==i){var o=i.split(t.options.separator);new r.Z.QueryHelper(a().extend(!0,{},t.options,{pattern:t})).search("UID","plone.app.querystring.operation.list.contains",o,(function(e){var i=e.results.reduce((function(e,t){return e[t.UID]=t,e}),{});try{n(o.map((function(e){return i[e]})).filter((function(e){return void 0!==e})))}catch(e){}t.openAfterInit&&(a()(t.el).select2("open"),t.openAfterInit=void 0)}),!1)}},t.options.tokenizer=function(e){"auto"===this.options.mode&&(this.browsing=!e)}.bind(this),t.options.id=function(e){return e.UID},h.prototype.initializeSelect2.call(t),t.$toolbar=a()('<div class="toolbar d-flex" />'),t.$container.prepend(t.$toolbar),t.$el.on("select2-selecting",(function(e){t.isSelectable(e.choice)||e.preventDefault()})),t.renderToolbar(),a()(document).on("keyup",t.$el,(function(e){if(h.prototype.opened.call(t)&&(e.which===y||e.which===b)){e.stopPropagation();var n=e.which===y?".pat-relateditems-result.one-level-up":".select2-highlighted",i=a()(".pat-relateditems-result-browse",n);if(1!==i.length)return;var o=i.data("path");t.browseTo(o)}}));case 49:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()})},58029:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var i=n(99269),a=n.n(i),o=n(98860),l=n(81421),s=n(76389),r=n(47575),c=n.n(r),p=n(13375),d=n(79184),u=n(24283),m=(l.Z.extend({name:"autotoc",trigger:".pat-autotoc",parser:"mockup",defaults:{section:"section",levels:"h1,h2,h3",IDPrefix:"autotoc-item-",classTOCName:"autotoc-nav",classSectionName:"autotoc-section",classLevelPrefixName:"autotoc-level-",classActiveName:"active",scrollDuration:"slow",scrollEasing:"swing"},init:function(){n.e(87110).then(n.bind(n,87110));var e=this;e.$toc=a()("<nav/>").addClass(e.options.classTOCName),e.options.prependTo?e.$toc.prependTo(e.options.prependTo):e.options.appendTo?e.$toc.appendTo(e.options.appendTo):e.$toc.prependTo(e.$el),e.options.className&&e.$el.addClass(e.options.className),a()(e.options.section,e.$el).addClass(e.options.classSectionName);var t=e.$el.hasClass("autotabs"),i=null;a()(e.options.levels,e.$el).each((function(n){var o=a()(this),l=o.prop("id")?o.prop("id"):o.parents(e.options.section).prop("id");(!l||a()("#"+l).length>0)&&(l=e.options.IDPrefix+e.name+"-"+n),window.location.hash==="#"+l&&(i=l),null===i&&o.hasClass(e.options.classActiveName)&&(i=l),o.data("navref",l),a()("<a/>").appendTo(e.$toc).text(o.text()).attr("id",l).attr("href","#"+l).addClass(e.options.classLevelPrefixName+e.getLevel(o)).on("click",(function(n,i){n.stopPropagation(),n.preventDefault(),i||(i={doScroll:!0,skipHash:!1});var l=a()(this);e.$toc.children("."+e.options.classActiveName).removeClass(e.options.classActiveName),e.$el.children("."+e.options.classActiveName).removeClass(e.options.classActiveName),a()(n.target).addClass(e.options.classActiveName),o.parents(e.options.section).addClass(e.options.classActiveName),!1!==i.doScroll&&e.options.scrollDuration&&o&&!t&&a()("body,html").animate({scrollTop:o.offset().top},e.options.scrollDuration,e.options.scrollEasing),0!==e.$el.parents(".plone-modal").length&&e.$el.trigger("resize.plone-modal.patterns"),a()(this).trigger("clicked"),i.skipHash||window.history&&window.history.pushState&&window.history.pushState({},"","#"+l.attr("id"))})),o.data("autotoc-trigger-id",l)})),i?a()("a#"+i).trigger("click",{doScroll:!0,skipHash:!0}):e.$toc.find("a").first().trigger("click",{doScroll:!1,skipHash:!0})},getLevel:function(e){var t=0;return a().each(this.options.levels.split(","),(function(n,i){if(1===e.filter(i).length)return t=n+1,!1})),t}}),n(46562),n(37103));function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}var f=l.Z.extend({name:"linktype",trigger:".pat-linktype-dummy",defaults:{linkModal:null},init:function(){this.linkModal=this.options.linkModal,this.tinypattern=this.options.tinypattern,this.tiny=this.tinypattern.tiny,this.dom=this.tiny.dom},getEl:function(){return this.$el.find("input")},value:function(){return a().trim(this.getEl().val())},toUrl:function(){return this.value()},load:function(e){this.getEl().attr("value",this.tiny.dom.getAttrib(e,"data-val"))},set:function(e){var t=this.getEl();t.attr("value",e),t.val(e)},attributes:function(){return{"data-val":this.value()}},updateRelatedItems:function(){}}),g=f.extend({name:"externallinktype",trigger:".pat-externallinktype-dummy",init:function(){f.prototype.init.call(this),this.getEl().on("change",(function(){var e=a()(this).val();new RegExp("https?://").test(e)||-1!==a()(this).val().split("/")[0].indexOf(".")&&a()(this).val("http://"+e)}))}}),v=f.extend({name:"internallinktype",trigger:".pat-internallinktype-dummy",init:function(){this.getEl().length&&(f.prototype.init.call(this),this.getEl().addClass("pat-relateditems"),this.createRelatedItems())},getEl:function(){return this.$el.find("input:not(.select2-input)")},createRelatedItems:function(){if(this.getEl().length){var e=this.linkModal.options.relatedItems;e.upload=!1,this.relatedItems=new u.default(this.getEl(),e)}},updateRelatedItems:function(e){this.relatedItems||this.createRelatedItems(),this.relatedItems.selectItem(e)},value:function(){var e=this.getEl().select2("data");return e&&"object"===h(e)&&(e=e[0]),e},toUrl:function(){var e=this.value();return e?this.tinypattern.generateUrl(e):null},load:function(e){var t=this.tiny.dom.getAttrib(e,"data-val");t&&this.set(t)},set:function(e){this.getEl().val(e).trigger("change"),this.updateRelatedItems(e)},attributes:function(){var e=this.value();return e?{"data-val":e.UID}:{}}}),y=f.extend({name:"uploadlinktype",trigger:".pat-uploadlinktype-dummy",getDelegatedLinkType:function(){return"uploadImage"===this.linkModal.linkType?this.linkModal.linkTypes.image:this.linkModal.linkTypes.internal},toUrl:function(){return this.getDelegatedLinkType().toUrl()},attributes:function(){return this.getDelegatedLinkType().attributes()},set:function(e){return this.getDelegatedLinkType().set(e)},load:function(e){return this.getDelegatedLinkType().load(e)},value:function(){return this.getDelegatedLinkType().value()}}),b=v.extend({name:"imagelinktype",trigger:".pat-imagelinktype-dummy",toUrl:function(){var e=this.value();return this.tinypattern.generateImageUrl(e,this.linkModal.$scale.val())}}),x=f.extend({name:"emaillinktype",trigger:".pat-emaillinktype-dummy",toUrl:function(){var e=this.value();if(e){var t=this.getSubject(),n="mailto:"+e;return t&&(n+="?subject="+t),n}return null},load:function(e){f.prototype.load.apply(this,[e]),this.linkModal.$subject.val(this.tiny.dom.getAttrib(e,"data-subject"))},getSubject:function(){return this.linkModal.$subject.val()},attributes:function(){var e=f.prototype.attributes.call(this);return e["data-subject"]=this.getSubject(),e}}),T=f.extend({name:"anchorlinktype",trigger:".pat-anchorlinktype-dummy",init:function(){f.prototype.init.call(this),this.$select=this.$el.find("select"),this.anchorNodes=[],this.anchorData=[],this.populate()},value:function(){var e=this.$select.select2("data");return e&&"object"===h(e)&&(e=e.id),e},populate:function(){var e,t,n,i,o,l=this;l.$select.find("option").remove(),l.anchorNodes=[],l.anchorData=[];var s=l.tiny.dom.select(".mceItemAnchor,.mce-item-anchor");for(t=0;t<s.length;t+=1)e=s[t],(i=l.tiny.dom.getAttrib(e,"name"))||(i=l.tiny.dom.getAttrib(e,"id")),""!==i&&(l.anchorNodes.push(e),l.anchorData.push({name:i,title:i}));if((s=l.tiny.dom.select(l.linkModal.options.anchorSelector)).length>0)for(t=0;t<s.length;t+=1)if(e=s[t],""!==(o=a()(e).text().replace(/^\s+|\s+$/g,""))){i=(i=o.toLowerCase().substring(0,1024)).replace(/[^a-z0-9]/g,"-");var r=!1;for(n=0;n<l.anchorNodes.length;n+=1){var c=l.anchorData[n];if(c.name===i){r=!0,c.title=o;break}}r||(l.anchorData.push({name:i,title:o,newAnchor:!0}),l.anchorNodes.push(e))}if(l.anchorNodes.length>0)for(t=0;t<l.anchorData.length;t+=1){var p=l.anchorData[t];l.$select.append('<option value="'+t+'">'+p.title+"</option>")}else l.$select.append("<option>No anchors found..</option>")},getIndex:function(e){for(var t=0;t<this.anchorData.length;t+=1){if(this.anchorData[t].name===e)return t}return 0},toUrl:function(){var e=this.value();if(e){var t=parseInt(e,10),n=this.anchorNodes[t],i=this.anchorData[t];return i.newAnchor&&(n.innerHTML='<a name="'+i.name+'" class="mce-item-anchor"></a>'+n.innerHTML),"#"+i.name}return null},set:function(e){var t=this.getIndex(e);this.$select.select2("data",""+t)}});c().PluginManager.add("ploneimage",(function(e){e.ui.registry.addButton("ploneimage",{icon:"image",text:"Insert image",tooltip:"Insert/edit image",onAction:e.settings.addImageClicked})})),c().PluginManager.add("plonelink",(function(e){e.ui.registry.addButton("plonelink",{icon:"link",tooltip:"Insert/edit link",shortcut:"Ctrl+K",onAction:e.settings.addLinkClicked,stateSelector:"a[href]"}),e.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){e.execCommand("unlink")},stateSelector:"a[href]"})}));var k=l.Z.extend({name:"linkmodal",trigger:".pat-linkmodal",defaults:{anchorSelector:"h1,h2,h3",linkTypes:[],initialLinkType:"internal",text:{insertHeading:"Insert Link"},linkTypeClassMapping:{internal:v,upload:y,external:g,email:x,anchor:T,image:b,uploadImage:y,externalImage:f}},linkTypeTemplateMapping:{internal:p,upload:p,external:p,email:p,anchor:p,image:d,uploadImage:d,externalImage:d},template:function(e){return o.ZP.template(this.linkTypeTemplateMapping[this.linkType])(e)},init:function(){var e=this;e.tinypattern=e.options.tinypattern,e.tinypattern.options.anchorSelector&&(e.options.anchorSelector=e.tinypattern.options.anchorSelector),e.tiny=e.tinypattern.tiny,e.dom=e.tiny.dom,e.linkType=e.options.initialLinkType,e.linkTypes={},e.modal=s.Z.patterns["plone-modal"].init(e.$el,{html:e.generateModalHtml(),content:null,buttons:".plone-btn",reloadWindowOnClose:!1,templateOptions:{classDialog:"modal-dialog modal-lg",reloadWindowOnClose:!1},actionOptions:{reloadWindowOnClose:!1},backdropOptions:{closeOnClick:!1}}),e.modal.on("shown",(function(t){e.modalShown.apply(e,[t])}))},isOnlyTextSelected:function(){var e=this.tiny.selection.getContent();if(/</.test(e)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(e)||-1===e.indexOf("href=")))return!1;if(this.anchorElm){var t=this.anchorElm.childNodes;if(0===t.length)return!1;for(var n=t.length-1;n>=0;n--)if(3!==t[n].nodeType)return!1}return!0},generateModalHtml:function(){return this.template({options:this.options,upload:this.options.upload,text:this.options.text,insertHeading:this.options.text.insertHeading,insertImageHelp:this.options.text.insertImageHelp,uploadText:this.options.text.upload,insertLinkHelp:this.options.text.insertLinkHelp,internal:this.options.text.internal,external:this.options.text.external,anchor:this.options.text.anchor,anchorLabel:this.options.text.anchorLabel,target:this.options.text.target,linkTypes:this.options.linkTypes,externalText:this.options.text.externalText,emailText:this.options.text.email,subjectText:this.options.text.subject,targetList:this.options.targetList,titleText:this.options.text.title,internalImageText:this.options.text.internalImage,externalImage:this.options.text.externalImage,externalImageText:this.options.text.externalImageText,altText:this.options.text.alt,imageAlignText:this.options.text.imageAlign,captionFromDescriptionText:this.options.text.captionFromDescription,enableImageZoom:this.options.text.enableImageZoom,captionText:this.options.text.caption,scaleText:this.options.text.scale,imageScales:this.options.imageScales,cancelBtn:this.options.text.cancelBtn,insertBtn:this.options.text.insertBtn})},isImageMode:function(){return-1!==["image","uploadImage","externalImage"].indexOf(this.linkType)},initElements:function(){var e=this;e.$target=a()('select[name="target"]',e.modal.$modal),e.$button=a()('.modal-footer input[name="insert"]',e.modal.$modal),e.$title=a()('input[name="title"]',e.modal.$modal),e.$subject=a()('input[name="subject"]',e.modal.$modal),e.$alt=a()('input[name="alt"]',e.modal.$modal),e.$align=a()('select[name="align"]',e.modal.$modal),e.$scale=a()('select[name="scale"]',e.modal.$modal),e.$enableImageZoom=a()('input[name="enableImageZoom"]',e.modal.$modal),e.$captionFromDescription=a()('input[name="captionFromDescription"]',e.modal.$modal),e.$caption=a()('textarea[name="caption"]',e.modal.$modal),o.ZP.each(e.options.linkTypes,(function(t){var n=a()(".linkType."+t+" .main",e.modal.$modal);n.length&&(e.linkTypes[t]=new e.options.linkTypeClassMapping[t](n,{linkModal:e,tinypattern:e.tinypattern}))})),a()(".autotoc-nav a",e.modal.$modal).click((function(){var t=a()("fieldset.linkType",e.modal.$modal).eq(a()(this).index())[0].className.split(/\s+/);o.ZP.each(t,(function(t){-1!==o.ZP.indexOf(e.options.linkTypes,t)&&(e.linkType=t)}))})),e.$captionFromDescription.change((function(){this.checked?e.$caption.prop("disabled",!0):e.$caption.prop("disabled",!1)}))},getLinkUrl:function(){return this.linkTypes[this.linkType].toUrl()},getValue:function(){return this.linkTypes[this.linkType].value()},updateAnchor:function(e){var t=this;t.tiny.focus(),t.tiny.selection.setRng(t.rng);var n=t.$target.val(),i=t.$title.val(),o=a().extend(!0,t.data,{title:i||null,target:n||null,"data-linkType":t.linkType,href:e},t.linkTypes[t.linkType].attributes());t.anchorElm?(t.onlyText&&o.text!==t.initialText&&("innerText"in t.anchorElm?t.anchorElm.innerText=t.data.text:t.anchorElm.textContent=t.data.text),t.tiny.dom.setAttribs(t.anchorElm,o),t.tiny.selection.select(t.anchorElm),t.tiny.undoManager.add()):t.onlyText?t.tiny.insertContent(t.tiny.dom.createHTML("a",o,t.tiny.dom.encode(t.data.text))):t.tiny.execCommand("mceInsertLink",!1,o)},focusElement:function(e){this.tiny.focus(),this.tiny.selection.select(e),this.tiny.nodeChanged()},updateImage:function(e){var t=this,n=t.$title.val(),i=t.$captionFromDescription.prop("checked"),o=t.$enableImageZoom.prop("checked");t.tiny.focus(),t.tiny.selection.setRng(t.rng);var l=["image-richtext",t.$align.val(),"scale-"+t.$scale.val()];i&&l.push("captioned"),o&&l.push("zoomable");var s=a().extend(!0,{},{src:e,title:n||null,alt:t.$alt.val(),class:l.join(" "),"data-linkType":t.linkType,"data-scale":t.$scale.val()},t.linkTypes[t.linkType].attributes());t.imgElm&&!t.imgElm.getAttribute("data-mce-object")?(s.width=t.dom.getAttrib(t.imgElm,"width"),s.height=t.dom.getAttrib(t.imgElm,"height")):t.imgElm=null,t.imgElm&&t.dom.remove(t.imgElm),t.captionElm&&t.dom.remove(t.captionElm),t.figureElm&&t.dom.remove(t.figureElm),s.id="__mcenew";var r,c,p=t.dom.createHTML("img",s),d=t.$caption.val();if(d&&!i){var u=document.createElement("div");u.innerHTML=p,u.querySelector("img").removeAttribute("class"),p=u.innerHTML,p+="\n"+t.dom.createHTML("figcaption",{},d),r=t.dom.createHTML("figure",{class:s.class},p)}else r=p;t.tiny.insertContent(r),t.imgElm=t.dom.get("__mcenew"),t.dom.setAttrib(t.imgElm,"id",null),(c=t.imgElm).onload=c.onerror=function(){c.onload=c.onerror=null,t.focusElement(c)},t.imgElm.complete&&t.focusElement(t.imgElm)},modalShown:function(e){var t=this;t.initElements(),t.initData(),t.options.upload&&(t.$upload=a()(".uploadify-me",t.modal.$modal),t.options.upload.relatedItems=a().extend(!0,{},t.options.relatedItems),t.options.upload.relatedItems.selectableTypes=t.options.folderTypes,t.$upload.addClass("pat-upload"),new m.default(t.$upload,t.options.upload),t.$upload.on("uploadAllCompleted",function(e,n){t.linkTypes.image?(t.linkTypes.image.set(n.data.UID),a()("#"+a()("#tinylink-image",t.modal.$modal).data("navref")).trigger("click")):(t.linkTypes.internal.set(n.data.UID),a()("#"+a()("#tinylink-internal",t.modal.$modal).data("navref")).trigger("click"))}.bind(t))),t.$button.off("click").on("click",(function(e){if(e.preventDefault(),e.stopPropagation(),t.linkType=t.modal.$modal.find("fieldset.active").data("linktype"),"uploadImage"===t.linkType||"upload"===t.linkType){var n=t.$upload.data().patternUpload;n.dropzone.files.length>0&&(n.processUpload(),t.$upload.on("uploadAllCompleted",(function(e,n){var i=0;!function e(){if(i<5&&!t.linkTypes[t.linkType].value())return i+=1,void setTimeout(e,100);var n=t.getLinkUrl();t.updateImage(n),t.hide()}()})))}var i;try{i=t.getLinkUrl()}catch(e){return}i&&(t.isImageMode()?t.updateImage(i):t.updateAnchor(i),t.hide())})),a()('.modal-footer input[name="cancel"]',t.modal.$modal).click((function(e){e.preventDefault(),t.hide()}))},show:function(){this.modal.show()},hide:function(){this.modal.hide()},initData:function(){var e,t,n,i,o,l=this;if(l.data={},l.initialText=null,l.rng=l.tiny.selection.getRng(),l.selectedElm=l.tiny.selection.getNode(),l.anchorElm=l.tiny.dom.getParent(l.selectedElm,"a[href]"),l.onlyText=l.isOnlyTextSelected(),l.data.text=l.initialText=l.anchorElm?l.anchorElm.innerText||l.anchorElm.textContent:l.tiny.selection.getContent({format:"text"}),l.data.href=l.anchorElm?l.tiny.dom.getAttrib(l.anchorElm,"href"):"",l.anchorElm?l.data.target=l.tiny.dom.getAttrib(l.anchorElm,"target"):l.tiny.settings.default_link_target&&(l.data.target=l.tiny.settings.default_link_target),(e=l.tiny.dom.getAttrib(l.anchorElm,"rel"))&&(l.data.rel=e),(e=l.tiny.dom.getAttrib(l.anchorElm,"class"))&&(l.data.class=e),(e=l.tiny.dom.getAttrib(l.anchorElm,"title"))&&(l.data.title=e),l.tiny.focus(),l.anchorElm=l.dom.getParent(l.selectedElm,"a[href]"),l.isImageMode()){if("FIGURE"===l.selectedElm.nodeName?(i=(n=l.selectedElm).querySelector("img"),o=n.querySelector("figcaption")):"IMG"===l.selectedElm.nodeName?(n=(n=a()(l.selectedElm).closest("figure")).length?n[0]:void 0,i=l.selectedElm,o=n?n.querySelector("figcaption"):void 0):"FIGCAPTION"===l.selectedElm.nodeName&&(i=(n=(n=a()(l.selectedElm).closest("figure")).length?n[0]:void 0)?n.querySelector("img"):void 0,o=l.selectedElm),l.imgElm=i,l.figureElm=n,l.captionElm=o,l.imgElm){var s=l.dom.getAttrib(l.imgElm,"src");if(l.$title.val(l.dom.getAttrib(l.imgElm,"title")),l.$alt.val(l.dom.getAttrib(l.imgElm,"alt")),a()(l.imgElm).hasClass("zoomable")&&l.$enableImageZoom.prop("checked",!0),a()(l.imgElm).hasClass("captioned")&&(l.$captionFromDescription.prop("checked",!0),l.$caption.prop("disabled",!0)),l.captionElm&&l.$caption.val(l.captionElm.innerHTML),t=l.dom.getAttrib(l.imgElm,"data-linktype")){l.linkType=t,l.linkTypes[l.linkType].load(l.imgElm);var r=l.dom.getAttrib(l.imgElm,"data-scale");l.$scale.val(r),a()("#tinylink-"+l.linkType,l.modal.$modal).trigger("click")}else s&&l.guessImageLink(s);for(var c=l.dom.getAttrib(l.imgElm,"class").split(" "),p=0;p<c.length;p+=1){var d=c[p];for(var u in l.options.imageClasses)-1!==u.indexOf(d)&&l.$align.val(d)}}}else if(l.anchorElm){l.focusElement(l.anchorElm);var m;if(m=l.dom.getAttrib(l.anchorElm,"href"),l.$target.val(l.dom.getAttrib(l.anchorElm,"target")),l.$title.val(l.dom.getAttrib(l.anchorElm,"title")),t=l.dom.getAttrib(l.anchorElm,"data-linktype")){l.linkType=t,l.linkTypes[l.linkType].load(l.anchorElm);var h=a()("#tinylink-"+l.linkType,l.modal.$modal);1===h.length&&a()("#"+h.data("autotoc-trigger-id")).trigger("click")}else m&&l.guessAnchorLink(m)}},guessImageLink:function(e){-1!==e.indexOf(this.options.prependToScalePart)?(this.linkType="image",this.$scale.val(this.tinypattern.getScaleFromUrl(e)),this.linkTypes.image.set(this.tinypattern.stripGeneratedUrl(e))):(this.linkType="externalImage",this.linkTypes.externalImage.set(e))},guessAnchorLink:function(e){if(this.options.prependToUrl&&-1!==e.indexOf(this.options.prependToUrl))this.linkType="internal",this.linkTypes.internal.set(this.tinypattern.stripGeneratedUrl(e));else if(-1!==e.indexOf("mailto:")){this.linkType="email";var t=e.substring("mailto:".length,e.length).split("?subject=");this.linkTypes.email.set(t[0]),t.length>1&&this.$subject.val(decodeURIComponent(t[1]))}else"#"===e[0]?(this.linkType="anchor",this.linkTypes.anchor.set(e.substring(1))):(this.linkType="external",this.linkTypes.external.set(e))},setSelectElement:function(e,t){e.find("option:selected").prop("selected",!1),t&&e.find('option[value="'+t+'"]').prop("selected",!0)},reinitialize:function(){this.modal.options.html=this.generateModalHtml()}})},37103:function(e,t,n){n.r(t);n(35666);var i,a,o,l,s=n(99269),r=n.n(s),c=n(98860),p=n(10354),d=n(81421),u=n(62832);function m(e,t,n,i,a,o,l){try{var s=e[o](l),r=s.value}catch(e){return void n(e)}s.done?t(r):Promise.resolve(r).then(i,a)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function l(e){m(o,i,a,l,s,"next",e)}function s(e){m(o,i,a,l,s,"throw",e)}l(void 0)}))}}t.default=d.Z.extend({name:"upload",trigger:".pat-upload",parser:"mockup",defaults:{showTitle:!0,url:null,className:"upload",wrap:!1,wrapperTemplate:'<div class="upload-wrapper"/>',fileaddedClassName:"dropping",useTus:!1,container:"",ajaxUpload:!0,paramName:"file",addRemoveLinks:!1,autoCleanResults:!0,previewsContainer:".previews",previewTemplate:null,maxFiles:null,maxFilesize:99999999,allowPathSelection:void 0,relatedItems:{attributes:["UID","Title","Description","getURL","portal_type","path","ModificationDate"],batchSize:20,basePath:"/",vocabularyUrl:null,width:500,maximumSelectionSize:1,selectableTypes:["Folder"]}},init:(l=h(regeneratorRuntime.mark((function e(){var t,a,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.e(84638).then(n.bind(n,84638)),n.e(88089).then(n.bind(n,88089)),e.next=4,n.e(32025).then(n.t.bind(n,32025,23));case 4:return(i=e.sent.default).autoDiscover=!1,e.next=8,n.e(94818).then(n.t.bind(n,94818,17));case 8:if(t=e.sent.default,void 0===(a=this).options.allowPathSelection&&(a.options.allowPathSelection=a.options.baseUrl&&a.options.relativePath),r()(document).bind("paste",(function(e){var t=e.originalEvent.clipboardData.items;if(t)for(var n=0;n<t.length;n++)if(-1!==t[n].type.indexOf("image")){var i=t[n].getAsFile();a.dropzone.addFile(i)}})),a.currentPath=a.options.currentPath,a.currentFile=0,o=c.ZP.template(t)({_t:p.Z,allowPathSelection:a.options.allowPathSelection}),a.$el.addClass(a.options.className),a.$el.append(o),a.$progress=r()(".progress-bar-success",a.$el),a.options.showTitle||a.$el.find("h2.title").hide(),a.options.ajaxUpload||(r()(".fallback",this.$el).remove(),this.$el.hasClass(".upload-container")?this.$el.addClass("no-ajax-upload"):this.$el.closest(".upload-container").addClass("no-ajax-upload")),a.options.wrap&&(a.$el.wrap(a.options.wrapperTemplate),a.$el=a.$el.parent()),!a.options.allowPathSelection){e.next=28;break}return a.$pathInput=r()('input[name="location"]',a.$el),e.next=25,a.setupRelatedItems(a.$pathInput);case 25:a.relatedItems=e.sent,e.next=30;break;case 28:r()('input[name="location"]',a.$el).parent().remove(),a.relatedItems=null;case 30:return a.$dropzone=r()(".upload-area",a.$el),r()("div.browse-select button.browse",a.$el).click((function(e){e.preventDefault(),e.stopPropagation(),(!a.options.maxFiles||a.dropzone.files.length<a.options.maxFiles)&&a.dropzone.hiddenFileInput.click()})),e.next=34,this.getDzoneOptions();case 34:l=e.sent,e.prev=35,a.dropzone=new i(a.$dropzone[0],l),e.next=43;break;case 39:throw e.prev=39,e.t0=e.catch(35),window.DEBUG&&console.log(e.t0),e.t0;case 43:a.dropzone.on("maxfilesreached",(function(){a.showHideControls()})),a.dropzone.on("addedfile",(function(){a.showHideControls()})),a.dropzone.on("removedfile",(function(){a.showHideControls()})),a.dropzone.on("success",(function(e,t){var n;try{n=r().parseJSON(t)}catch(e){n=t}a.$el.trigger("uploadAllCompleted",{data:n,path_uid:a.$pathInput?a.$pathInput.val():null})})),a.options.autoCleanResults&&a.dropzone.on("complete",(function(e){e.status===i.SUCCESS&&setTimeout((function(){r()(e.previewElement).fadeOut()}),3e3)})),a.dropzone.on("complete",(function(e){e.status===i.SUCCESS&&1===a.dropzone.files.length&&a.showHideControls()})),a.dropzone.on("error",(function(e,t,n){void 0!==n&&403!==n.status&&r()(".dz-error-message span",e.previewElement).html((0,p.Z)("The file transfer failed"))})),a.dropzone.on("totaluploadprogress",(function(e){e=(100*(a.currentFile-1)+e)/(100*a.dropzone.files.length)*100,a.$progress.attr("aria-valuenow",e).css("width",e+"%")})),r()(".upload-all",a.$el).click((function(e){e.preventDefault(),e.stopPropagation(),a.processUpload({finished:function(){a.$progress.attr("aria-valuenow",0).css("width","0%")}})})),a.options.clipboardfile&&a.dropzone.addFile(a.options.clipboardfile);case 53:case"end":return e.stop()}}),e,this,[[35,39]])}))),function(){return l.apply(this,arguments)}),showHideControls:function(){var e=this;e._showHideTimeout&&clearTimeout(e._showHideTimeout),e._showHideTimeout=setTimeout((function(){e._showHideControls()}),50)},_showHideControls:function(){var e=this,t=r()(".controls",e.$el),n=r()(".browse-select",e.$el),i=r()(".dz-hidden-input");if(e.options.maxFiles&&(e.dropzone.files.length<e.options.maxFiles?(n.show(),i.prop("disabled",!1)):(n.hide(),i.prop("disabled",!0))),e.dropzone.files.length>0){t.fadeIn("slow");var a=e.dropzone.files[0];r()(".dz-error-message span",a.previewElement).html("")}else t.fadeOut("slow")},pathJoin:function(){var e=[];return c.ZP.each(arguments,(function(t){t&&("/"===t[0]&&(t=t.substring(1)),"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),e.push(t))})),e.join("/")},getUrl:function(){var e=this,t=e.options.url;if(!t)if(e.options.baseUrl&&e.options.relativePath)"/"!==(t=e.options.baseUrl)[t.length-1]&&(t+="/"),t+=e.pathJoin(e.currentPath,e.options.relativePath);else{var n=e.$el.parents("form");t=n.length>0?n.attr("action"):window.location.href}return t},getDzoneOptions:(o=h(regeneratorRuntime.mark((function e(){var t,i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(51967).then(n.t.bind(n,51967,17));case 2:return t=(t=e.sent).default,(i=this).options.clickable=!0,(a=r().extend({},i.options)).url=i.getUrl(),a.headers={"X-CSRF-TOKEN":u.Z.getAuthenticator()},a.uploadMultiple=!1,delete a.wrap,delete a.wrapperTemplate,delete a.resultTemplate,delete a.autoCleanResults,delete a.fileaddedClassName,delete a.useTus,i.options.previewsContainer&&(o=i.$el.find(i.options.previewsContainer)).length>0&&(a.previewsContainer=o[0]),a.autoProcessQueue=!1,a.previewTemplate=t,e.abrupt("return",a);case 20:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)}),processUpload:function(e){e||(e={});var t=this,n=!1,a=t.options.useTus,o=t.options.fileaddedClassName,l=e.finished;t.currentFile=0,function e(){n=!0,0===t.dropzone.files.length&&(n=!1);var s=t.dropzone.files[0];if(n&&s.status===i.ERROR&&(s.status=i.QUEUED,n=!1),!n)return t.$el.removeClass(o),void(void 0!==l&&"function"==typeof l&&l());-1!==[i.SUCCESS,i.CANCELED].indexOf(s.status)?(t.dropzone.removeFile(s),e()):s.status!==i.UPLOADING?(a&&window.tus?t.handleTusUpload(s):(t.currentFile+=1,t.dropzone.processFile(s)),setTimeout(e,100)):setTimeout(e,100)}()},handleTusUpload:function(e){var t=this;r()(e.previewElement);e.status=i.UPLOADING,window.tus.upload(e,{endpoint:t.dropzone.options.url,headers:{FILENAME:e.name,"X-CSRF-TOKEN":u.Z.getAuthenticator()},chunkSize:5242880}).fail((function(){window.DEBUG&&console.alert((0,p.Z)("Error uploading with TUS resumable uploads")),e.status=i.ERROR})).progress((function(e,n,i){var a=n/i*100;t.$progress.attr("aria-valuenow",a).css("width",a+"%"),t.$progress.html((0,p.Z)("uploading...")+"<br />"+t.formatBytes(n)+" / "+t.formatBytes(i))})).done((function(e,n){n.status=i.SUCCESS,t.dropzone.emit("success",n),t.dropzone.emit("complete",n)}))},formatBytes:function(e){var t=Math.round(e/1024);if(t<1024)return t+" KiB";var n=Math.round(t/1024);return n<1024?n+" MB":Math.round(n/1024)+" GB"},setPath:function(e){var t=this;t.currentPath=e,t.options.url=null,t.options.url=t.dropzone.options.url=t.getUrl()},setupRelatedItems:(a=h(regeneratorRuntime.mark((function e(t){var i,a,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,24283));case 2:return i=e.sent.default,(o=(a=this).options.relatedItems).upload=!1,a.options.initialFolder&&t.attr("value",a.options.initialFolder),(l=new i(t,o)).$el.on("change",(function(){var e=r()(this).select2("data"),t=null;e.length>0&&(t=e[0].path),a.setPath(t)})),e.abrupt("return",l);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})})},79184:function(e){e.exports='<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n    <% if(_.contains(linkTypes, \'uploadImage\')){ %>\n    <p class="info"><%- insertImageHelp %></p>\n    <% } %>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;IDPrefix:tinymce-autotoc-">\n\n        <% if(_.contains(linkTypes, \'image\')){ %>\n      <fieldset class="linkType image" data-linkType="image">\n        <legend id="tinylink-image"><%- internalImageText %></legend>\n        <div>\n          <div class="main mb-2">\n            <input type="text" name="image" class="form-control" />\n          </div>\n          <div class="scale mb-2">\n            <label><%- scaleText %></label>\n            <select name="scale" class="form-select">\n              <option value="">Original</option>\n                <% _.each(imageScales, function(scale) { %>\n                  <option value="<%- scale.value %>" <% if (scale.value === options.defaultScale) { %>selected<% } %> >\n                    <%- scale.title %>\n                  </option>\n                <% }); %>\n            </select>\n          </div>\n        </div>\n      </fieldset>\n        <% } %>\n\n      <% if(_.contains(linkTypes, \'uploadImage\')){ %>\n      <fieldset class="linkType uploadImage" data-linkType="uploadImage">\n        <legend id="tinylink-uploadImage"><%- uploadText %></legend>\n        <div class="uploadify-me"></div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'externalImage\')){ %>\n      <fieldset class="linkType externalImage" data-linkType="externalImage">\n        <legend id="tinylink-externalImage"><%- externalImage %></legend>\n        <div>\n          <div class="main">\n            <label><%- externalImageText %></label>\n            <input type="text" name="externalImage" class="form-control" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n    </div>\x3c!-- / tabs --\x3e\n\n    <div class="common-controls mt-3 border-top pt-3">\n      <div class="title mb-2">\n        <label><%- titleText %></label>\n        <input type="text" name="title" class="form-control" />\n      </div>\n      <div class="text mb-2">\n        <label><%- altText %></label>\n        <input type="text" name="alt" class="form-control" />\n      </div>\n      <div class="captionFromDescription form-check mb-2">\n        <input type="checkbox" name="captionFromDescription" class="form-check-input" />\n        <label for="captionFromDescription" class="form-check-label">\n          <%- captionFromDescriptionText %>\n        </label>\n      </div>\n      <div class="caption mb-2">\n        <label><%- captionText %></label>\n        <textarea name="caption" class="form-control"></textarea>\n      </div>\n      <div class="align mb-2">\n        <label><%- imageAlignText %></label>\n        <select name="align" class="form-select">\n          <% _.each(Object.keys(options.imageClasses), function(align){ %>\n              <option value="<%- align %>">\n              <%- options.imageClasses[align] %>\n              </option>\n          <% }); %>\n        </select>\n      </div>\n      <div class="enable-zoom mb-2">\n        <input type="checkbox" name="enableImageZoom" class="form-check-input" />\n        <label for="enableImageZoom" class="form-check-label">\n          <%- enableImageZoom %>\n        </label>\n      </div>\n    </div>\n\n    <input type="submit" class="btn btn-secondary plone-btn me-1" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="btn btn-primary plone-btn" name="insert" value="<%- insertBtn %>" />\n\n  </div>\n</div>\n'},13375:function(e){e.exports='<div>\n  <div class="linkModal">\n    <h1><%- insertHeading %></h1>\n    <% if(_.contains(linkTypes, \'upload\')){ %>\n    <p class="info"><%- insertLinkHelp %></p>\n    <% } %>\n\n    <div class="linkTypes pat-autotoc autotabs"\n         data-pat-autotoc="section:fieldset;levels:legend;IDPrefix:tinymce-autotoc-">\n\n      <% if(_.contains(linkTypes, \'internal\')){ %>\n      <fieldset class="linkType internal" data-linkType="internal">\n        <legend id="tinylink-internal"><%- internal %></legend>\n        <div>\n          <div class="main mb-2">\n            \x3c!-- this gives the name to the "linkType" --\x3e\n            <input type="text" name="internal" class="form-control" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'upload\')){ %>\n      <fieldset class="linkType upload" data-linkType="upload">\n        <legend id="tinylink-upload"><%- uploadText %></legend>\n        <div class="uploadify-me"></div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'external\')){ %>\n      <fieldset class="linkType external" data-linkType="external">\n        <legend id="tinylink-external"><%- external %></legend>\n        <div class="main mb-2">\n          <label for="external"><%- externalText %></label>\n          <input type="text" name="external" class="form-control" />\n        </div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'email\')){ %>\n      <fieldset class="linkType email" data-linkType="email">\n        <legend id="tinylink-email"><%- emailText %></legend>\n        <div>\n          <div class="main mb-2">\n            <label><%- emailText %></label>\n            <input type="text" name="email" class="form-control" />\n          </div>\n          <div class="mb-2">\n            <label><%- subjectText %></label>\n            <input type="text" name="subject" class="form-control" />\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n      <% if(_.contains(linkTypes, \'anchor\')){ %>\n      <fieldset class="linkType anchor" data-linkType="anchor">\n        <legend id="tinylink-anchor"><%- anchor %></legend>\n        <div>\n          <div class="main mb-2">\n            <label><%- anchorLabel %></label>\n            <div class="input-wrapper">\n              <select name="anchor" class="pat-select2" data-pat-select2="width:500px"></select>\n            </div>\n          </div>\n        </div>\n      </fieldset>\n      <% } %>\n\n    </div>\x3c!-- / tabs --\x3e\n\n    <div class="common-controls mt-3 border-top pt-3">\n      <div class="mb-2">\n        <label><%- target %></label>\n        <select name="target" class="form-select">\n          <% _.each(targetList, function(target){ %>\n            <option value="<%- target.value %>"><%- target.text %></option>\n          <% }); %>\n        </select>\n      </div>\n      <div class="mb-2">\n        <label><%- titleText %></label>\n        <input type="text" name="title" class="form-control" />\n      </div>\n    </div>\n\n    <input type="submit" class="btn btn-secondary plone-btn me-1" name="cancel" value="<%- cancelBtn %>" />\n    <input type="submit" class="btn btn-primary plone-btn" name="insert" value="<%- insertBtn %>" />\n  </div>\n</div>\n'}}]);
//# sourceMappingURL=58029.f4ccad813e88be13ce0b.min.js.map