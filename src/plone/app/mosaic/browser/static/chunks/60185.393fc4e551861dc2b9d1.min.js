"use strict";(self.webpackChunkplone_mosaic=self.webpackChunkplone_mosaic||[]).push([[60185],{60185:function(e,a,i){i.r(a),i.d(a,{default:function(){return f}});i(35666);var s=i(65311),t=i.n(s),o=i(98860),n=i(89867),c=i(47575),l=i.n(c),r=i(83364);i(41973);function d(e,a){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,a){if(!e)return;if("string"==typeof e)return m(e,a);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return m(e,a)}(e))||a&&e&&"number"==typeof e.length){i&&(e=i);var s=0,t=function(){};return{s:t,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,c=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return n=e.done,e},e:function(e){c=!0,o=e},f:function(){try{n||null==i.return||i.return()}finally{if(c)throw o}}}}function m(e,a){(null==a||a>e.length)&&(a=e.length);for(var i=0,s=new Array(a);i<a;i++)s[i]=e[i];return s}function h(e,a,i,s,t,o,n){try{var c=e[o](n),l=c.value}catch(e){return void i(e)}c.done?a(l):Promise.resolve(l).then(s,t)}function p(e,a){for(var i=0;i<a.length;i++){var s=a[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var u=n.Z.getLogger("pat-mosaic"),f=function(){function e(a){var i,s,t;!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e),t={widthClasses:["col","col-1","col-2","col-3","col-4","col-5","col-6","col-7","col-8","col-9","col-10","col-11","col-12"],dataClasses:["mosaic-col","mosaic-col-1","mosaic-col-2","mosaic-col-3","mosaic-col-4","mosaic-col-5","mosaic-col-6","mosaic-col-7","mosaic-col-8","mosaic-col-9","mosaic-col-10","mosaic-col-11","mosaic-col-12"],positionClasses:["mosaic-position-0","mosaic-position-1","mosaic-position-2","mosaic-position-3","mosaic-position-4","mosaic-position-5","mosaic-position-6","mosaic-position-7","mosaic-position-8","mosaic-position-9","mosaic-position-10","mosaic-position-11","mosaic-position-12"],resizeHandleClasses:["mosaic-resize-handle-1","mosaic-resize-handle-2","mosaic-resize-handle-3","mosaic-resize-handle-4","mosaic-resize-handle-5","mosaic-resize-handle-6","mosaic-resize-handle-7","mosaic-resize-handle-8","mosaic-resize-handle-9","mosaic-resize-handle-10","mosaic-resize-handle-11","mosaic-resize-handle-12"]},(s="layout")in(i=this)?Object.defineProperty(i,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[s]=t,this.mosaic=a}var a,i,s,n,c;return a=e,i=[{key:"disableEditHtmlSource",value:function(){var e=this;t()(".mosaic-rich-text-textarea",e.mosaic.document).each((function(){var a;a=t()(this).val(),t()(this).parent().html(a),new r.default(e.mosaic,t()(this).parent()).setupWysiwyg()}))}},{key:"addAppTile",value:function(e,a){var i=this;i.mosaic.overlay.app&&i.mosaic.overlay.app.hide(),t().ajax({type:"GET",url:a,success:function(s){s=i.mosaic.getDomTreeFromHtml(s),i.mosaic.addHeadTags(a,s),i.addTile(e,s.find(".temp_body_tag").html(),a)}})}},{key:"addAppTileHTML",value:function(e,a,i){var s,t=this;s=t.mosaic.getDomTreeFromHtml(a),t.mosaic.addHeadTags(i,s),t.addTile(e,s.find(".temp_body_tag").html(),i)}},{key:"editAppTile",value:function(e){var a=this;a.mosaic.overlay.close(),window.parent.focus(),t().ajax({type:"GET",url:e,success:function(i){i=a.mosaic.getDomTreeFromHtml(i),a.mosaic.removeHeadTags(e),a.mosaic.addHeadTags(e,i);var s=t()(".mosaic-selected-tile .mosaic-tile-content",a.mosaic.document);s.html(i.find(".temp_body_tag").html()),s.attr("data-tileUrl",e.replace(/&/gim,"&amp;"))}})}},{key:"addTile",value:function(e,a,i){var s=this;s.mosaic.panels.addClass("mosaic-panel-dragging mosaic-panel-dragging-new"),t()(s.mosaic.panels.get(0)).append(t()(s.mosaic.document.createElement("div")).addClass("mosaic-grid-row").append(t()(s.mosaic.document.createElement("div")).addClass("mosaic-grid-cell col").append(t()(s.mosaic.document.createElement("div")).addClass("movable removable mosaic-tile mosaic-"+e+"-tile").append(t()(s.mosaic.document.createElement("div")).addClass("mosaic-tile-content").attr("data-tileUrl",i&&i.replace(/&/gim,"&amp;")).html(a)).addClass("mosaic-helper-tile mosaic-helper-tile-new mosaic-original-tile"))));var o=s.mosaic.panels.find(".mosaic-helper-tile-new"),n=0;s.mosaic.panels.each((function(){t()(this).width()>n&&(n=t()(this).width())})),o.width()<n/4?o.width(n/4):o.width(o.width());var c=new r.default(s.mosaic,o);c.initialize(),c.cacheHtml(),c.scanRegistry()}},{key:"getDefaultValue",value:function(e){var a,i,s,o;if("IDublinCore-title"===e.name?(s='<h1 class="documentFirstHeading">',o="</h1>"):"IDublinCore-description"===e.name?(s='<p class="documentDescription">',o="</p>"):(s="<div>",o="</div>"),"field"===e.tile_type)switch(e.widget){case"z3c.form.browser.text.TextWidget":case"z3c.form.browser.text.TextFieldWidget":return s+t()("#"+e.id,this.mosaic.document).find("input").attr("value")+o;case"z3c.form.browser.textarea.TextAreaWidget":case"z3c.form.browser.textarea.TextAreaFieldWidget":case"z3c.form.browser.textlines.TextLinesWidget":case"z3c.form.browser.textlines.TextLinesFieldWidget":for(var n=t()("#"+e.id,this.mosaic.document).find("textarea").val().split("\n"),c="",r=0;r<n.length;r+=1)c+=n[r]+"<br/>";return s+c+o;case"plone.app.z3cform.widget.RichTextFieldWidget":case"plone.app.z3cform.wysiwyg.widget.WysiwygWidget":case"plone.app.z3cform.wysiwyg.widget.WysiwygFieldWidget":case"plone.app.widgets.dx.RichTextWidget":if(a=t()("#"+e.id).find("textarea").attr("id"),!(i=l().get(a)))return"";try{return i.getContent()}catch(a){return'<div class="discreet">Placeholder for field:<br/><b>'+e.label+"</b></div>"}default:return'<div class="discreet">Placeholder for field:<br/><b>'+e.label+"</b></div>"}return e.default_value}},{key:"getPageContent",value:function(e){var a,i=this,s=function a(s){var o="";return!1===t()(s).hasClass("mosaic-empty-row")&&t()(s).find(".mosaic-tile").length>=0&&(n=t()(s).attr("class"),o+='      <div class="'+n+'">\n',t()(s).children(".mosaic-grid-cell").each((function(){o+='        <div class="'+t()(this).attr("class")+'">\n',t()(this).children().each((function(){if(t()(this).hasClass("mosaic-tile")){var s=new r.default(i.mosaic,this);o+=s.getHtmlBody(e)}else t()(this).hasClass("mosaic-innergrid-row")&&(o+=a(this))})),o+="        </div>\n"})),o+="      </div>\n"),o},o="",n="";return i.disableEditHtmlSource(),o+="  <body>\n",t()("[data-panel]",i.mosaic.document).each((function(){o+='    <div data-panel="'+t()(this).data("panel")+'"',o+='         data-max-columns="'+t()(this).data("max-columns")+'">\n',t()(this).children().each((function(){t()(this).hasClass("mosaic-grid-row")&&(o+=s(this))})),o+="    </div>\n"})),o+="  </body>\n",a='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" data-layout="'+i.mosaic.options.layout+'">\n',a+=o,a+="</html>\n"}},{key:"saveTileFormData",value:function(){var e=this;t()("[data-panel]",e.mosaic.document).each((function(){t()(this).find(".mosaic-tile").each((function(){new r.default(e.mosaic,this).saveForm()}))}))}},{key:"saveLayoutToForm",value:function(){var e=this;e.saveTileFormData();var a=t()("#form-widgets-ILayoutAware-customContentLayout, [name='form.widgets.ILayoutAware.customContentLayout']");e.mosaic.hasContentLayout?a.val(""):a.val(e.getPageContent())}},{key:"init_events",value:function(){var e=this;t()(e.mosaic.document).off("keydown").on("keydown",(function(a){if(18===a.keyCode)if(t()(".mosaic-panel",e.mosaic.document).hasClass("mosaic-advanced"))t()(".mosaic-panel",e.mosaic.document).removeClass("mosaic-advanced");else{var i=new Date;t()(".mosaic-panel",e.mosaic.document).addClass("mosaic-advanced"),t()(".mosaic-panel",e.mosaic.document).data("advanced-enabled",i.getTime())}if(17===a.keyCode&&t()(".mosaic-panel",e.mosaic.document).addClass("inner-subcolumn"),27===a.keyCode){var s=t()(".mosaic-original-tile",e.mosaic.document);s.length>0?s.each((function(){t()(this).addClass("mosaic-drag-cancel"),t()(this).hasClass("mosaic-helper-tile-new")?t()(document).trigger("mousedown"):t()(document).trigger("mouseup")})):t()(".mosaic-selected-tile",e.mosaic.document).each((function(){new r.default(e.mosaic,this).trigger("blur")})),t()(".mosaic-resize-handle-helper",e.mosaic.document).each((function(){t()(this).parents("[data-panel]").removeClass("mosaic-panel-resizing"),t()(this).parent().removeClass("mosaic-row-resizing"),t()(this).parent().children(".mosaic-resize-placeholder").remove(),t()(this).remove()})),e.mosaic.overlay.app&&e.mosaic.overlay.app.hide()}})),t()(e.mosaic.document).off("keyup").on("keyup",(function(a){if(18===a.keyCode){var i=new Date,s=t()(".mosaic-panel",e.mosaic.document).data("advanced-enabled");i.getTime()-s>400&&t()(".mosaic-panel",e.mosaic.document).removeClass("mosaic-advanced")}17===a.keyCode&&t()(".mosaic-panel",e.mosaic.document).removeClass("inner-subcolumn")})),t()(e.mosaic.document).off("mousedown").on("mousedown",(function(a){var i;if(a.target?i=a.target:a.srcElement&&(i=a.srcElement),!(t()(i).parents(".mce-panel").length>0)){0===t()(i).parents(".mosaic-tile").length&&0===t()(i).parents(".mosaic-toolbar").length&&(t()(".mosaic-selected-tile",e.mosaic.document).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").trigger("blur"),e.mosaic.toolbar.SelectedTileChange());var s=t()(".mosaic-helper-tile-new",e.mosaic.document);s.length>0&&s.each((function(){t()(this).mosaicHandleDragEnd()}))}}));var a=function(a){t()(".mosaic-helper-tile-new",e.mosaic.document).each((function(){var e=t()(this).parent().offset();t()(this).css("top",a.pageY+3-e.top),t()(this).css("left",a.pageX+3-e.left)})),t()(".mosaic-resize-handle-helper",e.mosaic.document).each((function(){var i;u.info("===================");var s=t()(this),o=s.parent(),n=s.data("resize_handle_index"),c=parseFloat(a.pageX-o.offset().left-4),l=Math.round(c/s.data("row_width")*100),r=8,d=8,m=g();t()(m).each((function(){(i=Math.abs(this-l))<d&&(r=this,d=i)}));var h=function(e){for(var a=g(),i=0;i<a.length;i++)if(e===a[i])return i+1;return 12}(r),p=[];o.children(".mosaic-resize-placeholder").each((function(){var e=w(t()(this).mosaicGetWidthClass());p.push(e)}));for(var f=0,v=0,y=0;y<p.length;y++)y<n&&(f+=p[y]?p[y]:2),y==n&&p[y],y>n&&(v+=p[y]?p[y]:2);var z=h-f,b=12-f-v,E=f+(z=z>b?b:z<0?0:z);u.info("column_sizes",p),u.info("snap_size",h),u.info("col_size_before",f),u.info("col_size_after",v),u.info("col_size_max",b),u.info("col_size",z),u.info("col_size_handle",E),u.info("resize_handle_index",n),s.data("nr_of_columns")>1&&(o.children(".mosaic-resize-placeholder").each((function(a){if(a===n){p[a]=z;var i="mosaic-resize-0";if(p.length>1&&a>0){for(var s=0,o=0;o<a;o++)s+=p[o];i="mosaic-resize-"+s}var c=C(z);t()(this).removeClass(e.layout.widthClasses.join(" ")).removeClass(e.layout.dataClasses.join(" ")).removeClass(e.layout.positionClasses.join(" ").replace(/position/g,"resize")).addClass("mosaic-"+c+" "+c+" "+i).find(".info").html(z)}})),t()(this).data("column_sizes",p))}))};t()(e.mosaic.document).off("mousemove").on("mousemove",a),t()(e.mosaic.document).off("dragover").on("dragover",a),t()(e.mosaic.document).off("mouseup").on("mouseup",(function(){t()(".mosaic-resize-handle-helper",e.mosaic.document).each((function(){var a=t()(this).data("resize_handle_index");t()(this).parent().parent().mosaicCleanupRow();var i=t()(this).parents("[data-panel]"),s=t()(this).data("column_sizes");t()(this).parent().children(".mosaic-grid-cell").each((function(i){for(var o=0;o<i;o++)s[o];t()(this).removeClass(e.layout.positionClasses.join(" ")).removeClass(e.layout.widthClasses.join(" ")).addClass(C(s[i])),t()(this).hasClass("col")||i!==a||t()(this).children(".mosaic-tile").first().children(".mosaic-tile-side-tools").each((function(){var a=t()(this);a.children(".mosaic-tile-label.reset").remove(),a.append(t()(e.mosaic.document.createElement("div")).addClass("mosaic-tile-label reset").append(v(a,s[i])))}))})),i.removeClass("mosaic-panel-resizing"),t()(this).parent().removeClass("mosaic-row-resizing"),t()(this).parent().children(".mosaic-resize-placeholder").remove(),t()(this).parent().mosaicSetResizeHandles();var o=i.find(".mosaic-selected-tile");o.length>0&&new r.default(e.mosaic,o).select(),t()(this).remove()}))}));var i=function(a){if(t()(this).parents("[data-panel]").hasClass("mosaic-panel-dragging")&&(t()(".mosaic-selected-divider",e.mosaic.document).removeClass("mosaic-selected-divider"),!1===t()(this).hasClass("mosaic-original-tile")&&!1===t()(this).hasClass("mosaic-tile-align-left")&&!1===t()(this).hasClass("mosaic-tile-align-right"))){var i=t()(this).mosaicGetDirection(a),s=t()(this).children(".mosaic-divider-"+i);if("left"===i||"right"===i){var o=s.parent().parent().parent();if(o.children(".mosaic-grid-cell").length>=t()(".mosaic-panel").data("max-columns"))return;o.children(".mosaic-grid-cell").length>1?(s.height(o.height()+5),s.css("top",o.offset().top-s.parent().offset().top-5)):(s.height(s.parent().height()+5),s.css("top",-5))}s.addClass("mosaic-selected-divider")}};t()(e.mosaic.document).off("mousemove",".mosaic-tile").on("mousemove",".mosaic-tile",i),t()(e.mosaic.document).off("dragover",".mosaic-tile").on("dragover",".mosaic-tile",i),t()(e.mosaic.document).off("click",".mosaic-tile").on("click",".mosaic-tile",(function(){0===t()(".mosaic-helper-tile-new",e.mosaic.document).length&&new r.default(e.mosaic,this).select()})),t()(e.mosaic.document).on("dblclick",".mosaic-grid-row",(function(e){var a=t()(e.target);if(a.parents("[data-panel]").hasClass("mosaic-advanced")&&a.hasClass("mosaic-grid-row")){if(t()(a).find(".mosaic-set-custom-css").length>0)return;var i=[];t().each(a.attr("class").split(" "),(function(){void 0!==this&&"mosaic-grid-row"!==this&&"mosaic-innergrid-row"!==this&&i.push(this)}));var s=t()("<input type='text' id='custom-css-input-box'></input>").val(i.join(" ")),o=t()("<div></div>").addClass("mosaic-set-custom-css").append(t()("<label>Custom CSS for this row:</label>")).append(s);a.append(o)}})),t()(e.mosaic.document).on("click",(function(e){"custom-css-input-box"!==t()(e.target).attr("id")&&t().each(t()("div.mosaic-set-custom-css"),(function(){var e=t()(this).parent(),a="mosaic-grid-row";e.hasClass("mosaic-innergrid-row")&&(a="mosaic-grid-row mosaic-innergrid-row"),a+=" "+t()(this).find("input#custom-css-input-box").val(),e.attr("class",a),t()(this).remove()}))}))}},{key:"initialize_panels",value:(n=regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=this).initJQueryHelpers(),a.init_events(),i=a.mosaic.panels.length,e.abrupt("return",a.mosaic.panels.each((function(e){var s=t()(this);if(s.find(".mosaic-tile").each((function(){var e=new r.default(a.mosaic,this);e.initialize(),e.scanRegistry()})),s.find(".mosaic-tile").mosaicAddDrag(),s.mosaicAddEmptyRows(),s.children(".mosaic-grid-row").mosaicSetResizeHandles(),e===i-1){var n=0,c=0;a.mosaic.panels.each((function(e){t()(this).width()>n&&(n=t()(this).width(),c=e)}));var l=a.mosaic.panels.eq(c).find(".mosaic-tile:first");l.length>0&&new r.default(a.mosaic,l).select()}s.find(".mosaic-innergrid-row").each((function(){t()(this).mosaicAddMouseMoveInnergridRow(),t()(this).mosaicSetResizeHandles();var e=t()(this);o.ZP.each(["top","bottom"],(function(i){e.append(t()(a.mosaic.document.createElement("div")).addClass("mosaic-divider mosaic-divider-"+i).append(t()(a.mosaic.document.createElement("div")).addClass("mosaic-divider-dot")))}))}))})));case 5:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,a=arguments;return new Promise((function(i,s){var t=n.apply(e,a);function o(e){h(t,i,s,o,c,"next",e)}function c(e){h(t,i,s,o,c,"throw",e)}o(void 0)}))},function(){return c.apply(this,arguments)})},{key:"initJQueryHelpers",value:function(){var e=this,a=e.mosaic.document;t().fn.mosaicAddMouseMoveEmptyRow=function(){return this.each((function(){t()(this).mousemove((function(){t()(this).parents("[data-panel]").hasClass("mosaic-panel-dragging")&&(t()(".mosaic-selected-divider",a).removeClass("mosaic-selected-divider"),t()(this).children("div").addClass("mosaic-selected-divider"))}))}))},t().fn.mosaicAddMouseMoveInnergridRow=function(){return this.each((function(){t()(this).mousemove((function(e){if(t()(this).parents("[data-panel]").hasClass("mosaic-panel-dragging")){t()(".mosaic-selected-divider",a).removeClass("mosaic-selected-divider");var i=t()(this).mosaicGetDirection(e);t()(this).children(".mosaic-divider-"+i).addClass("mosaic-selected-divider")}}))}))},t().fn.mosaicAddEmptyRows=function(){return this.each((function(){t()(this).find(".mosaic-grid-row:not(.mosaic-innergrid-row)").each((function(){t()(this).before(t()(a.createElement("div")).addClass("mosaic-grid-row mosaic-empty-row").append(t()(a.createElement("div")).addClass("mosaic-grid-cell col").append(t()(a.createElement("div")).append(t()(a.createElement("div")).addClass("mosaic-tile-outer-border").append(t()(a.createElement("div")).addClass("mosaic-divider-dot"))))).mosaicAddMouseMoveEmptyRow()),0===t()(this).nextAll(".mosaic-grid-row").length&&t()(this).after(t()(a.createElement("div")).addClass("mosaic-grid-row mosaic-empty-row").append(t()(a.createElement("div")).addClass("mosaic-grid-cell col").append(t()(a.createElement("div")).append(t()(a.createElement("div")).addClass("mosaic-tile-outer-border").append(t()(a.createElement("div")).addClass("mosaic-divider-dot"))))).mosaicAddMouseMoveEmptyRow())})),0===t()(this).find(".mosaic-grid-row:not(.mosaic-innergrid-row)").length&&t()(this).append(t()(a.createElement("div")).addClass("mosaic-grid-row mosaic-empty-row").append(t()(a.createElement("div")).addClass("mosaic-grid-cell col").append(t()(a.createElement("div")).append(t()(a.createElement("div")).addClass("mosaic-tile-outer-border").append(t()(a.createElement("div")).addClass("mosaic-divider-dot"))))).mosaicAddMouseMoveEmptyRow())}))},t().fn.mosaicGetDataClass=function(){var a,i=d(e.layout.dataClasses);try{for(i.s();!(a=i.n()).done;){var s=a.value;if(t()(this).hasClass(s))return s}}catch(e){i.e(e)}finally{i.f()}return e.layout.dataClasses[0]},t().fn.mosaicGetWidthClass=function(){var a,i=d(e.layout.widthClasses);try{for(i.s();!(a=i.n()).done;){var s=a.value,o=s,n=s.replace("position","resize");if(t()(this).hasClass(o)||t()(this.hasClass(n)))return s}}catch(e){i.e(e)}finally{i.f()}return e.layout.widthClasses[0]},t().fn.mosaicGetPositionClass=function(){var a,i=d(e.layout.positionClasses);try{for(i.s();!(a=i.n()).done;){var s=a.value,o=s,n=s.replace("position","resize");if(t()(this).hasClass(o)||t()(this.hasClass(n)))return s}}catch(e){i.e(e)}finally{i.f()}return e.layout.positionClasses[0]},t().fn.mosaicGetResizeHandleClassId=function(){for(var a=0;a<e.layout.resizeHandleClasses.length;a++)if(t()(this).hasClass(e.layout.resizeHandleClasses[a]))return a;return 1},t().fn.mosaicAddDrag=function(){return this.each((function(){var i=t()(this),s=function(e){var i=t()(".mosaic-helper-tile",a),s=i.parents("[data-panel]").offset();i.css("top",e.pageY+3-s.top),i.css("left",e.pageX+3-s.left)},o=function e(){var i=t()(".mosaic-helper-tile",a);t()(a).off("mousemove",s).off("mouseup",e),i.mosaicHandleDragEnd(),i.remove()};return i.each((function(){i.find("div.mosaic-drag-handle").off("mousedown").on("mousedown",(function(i){var n=i.pageX,c=i.pageY,l=function i(l){if(Math.max(Math.abs(n-l.pageX),Math.abs(c-l.pageY))>=1){e.mosaic.panels.addClass("mosaic-panel-dragging"),t()(".mosaic-selected-tile",a).removeClass("mosaic-selected-tile").children(".mosaic-tile-content").trigger("blur");var r=t()(l.target).parents(".mosaic-tile"),d=r.clone(!0);r.addClass("mosaic-original-tile"),r.parents("[data-panel]").append(d),d.css({width:r.width(),"max-height":"50%",position:"absolute",opacity:.5}).addClass("mosaic-helper-tile"),t()(a).on("mousemove",s),t()(a).on("mouseup",o),t()(a).off("mousemove",i)}};t()(a).on("mousemove",l),t()(a).on("mouseup",(function(){t()(a).off("mousemove",l)}))}))}))}))},t().fn.mosaicHandleDragEnd=function(){var i=t()(this).parents("[data-panel]");e.mosaic.panels.removeClass("mosaic-panel-dragging mosaic-panel-dragging-new");var s=t()(".mosaic-selected-divider",a),n=s.parent(),c="";o.ZP.each(["top","bottom","left","right"],(function(e){s.hasClass("mosaic-divider-"+e)&&(c=e)})),s.removeClass("mosaic-selected-divider");var l=t()(".mosaic-helper-tile-new",a).length>0,d=t()(".mosaic-original-tile",a);if((0===s.length||n.hasClass("mosaic-helper-tile"))&&d.addClass("mosaic-drag-cancel"),d.hasClass("mosaic-drag-cancel"))d.removeClass("mosaic-drag-cancel"),l||d.removeClass("mosaic-original-tile").addClass("mosaic-new-tile");else if(n.hasClass("mosaic-empty-row"))n.removeClass("mosaic-empty-row").attr("class",d.parents(".mosaic-grid-row").first().attr("class")).unbind("mousemove"),n.children(".mosaic-grid-cell").children("div").remove(),n.children(".mosaic-grid-cell").append(d.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"));else if(!1===n.hasClass("mosaic-tile")&&!1===n.hasClass("mosaic-innergrid-row"))l||d.removeClass("mosaic-original-tile").addClass("mosaic-new-tile");else if(n.parent().parent().children(".mosaic-grid-cell").length>=i.data("max-columns")&&("left"===c||"right"===c))l||d.removeClass("mosaic-original-tile").addClass("mosaic-new-tile");else{var m=d.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile");if(i.hasClass("inner-subcolumn")&&(m=t()(a.createElement("div")).addClass("mosaic-grid-row mosaic-innergrid-row").append(t()(a.createElement("div")).addClass("mosaic-grid-cell col").append(t()(a.createElement("div")).append(t()(a.createElement("div")).addClass("mosaic-innergrid-outer-border"))).append(m)).mosaicAddMouseMoveInnergridRow(),o.ZP.each(["top","bottom"],(function(e){m.append(t()(a.createElement("div")).addClass("mosaic-divider mosaic-divider-"+e).append(t()(a.createElement("div")).addClass("mosaic-divider-dot")))}))),"top"===c)n.before(m);else if("bottom"===c)n.after(m);else if("left"===c||"right"===c)if(1===n.parent().parent().children(".mosaic-grid-cell").length){var h=n.prevAll();h.length>0&&(n.parent().parent().before(t()(a.createElement("div")).addClass("mosaic-grid-row").append(t()(a.createElement("div")).addClass("mosaic-grid-cell col").append(t()(h.get().reverse()).clone(!0).mosaicAddDrag()))),h.remove());var p=n.nextAll();p.length>0&&(n.parent().parent().after(t()(a.createElement("div")).addClass("mosaic-grid-row").append(t()(a.createElement("div")).addClass("mosaic-grid-cell col").append(p.clone(!0).mosaicAddDrag()))),p.remove()),n.parent().removeClass(e.mosaic.layout.widthClasses.join(" ")).removeClass(e.mosaic.layout.positionClasses.join(" ")).addClass("col"),u.info("Now inside here left right"),"left"===c?n.parent().before(t()(a.createElement("div")).addClass("mosaic-grid-cell col").append(d.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"))):n.parent().after(t()(a.createElement("div")).addClass("mosaic-grid-cell col").append(d.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"))),n.parent().parent().mosaicSetResizeHandles()}else"left"===c?n.parent().before(t()(a.createElement("div")).addClass("mosaic-grid-cell").append(d.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"))):n.parent().after(t()(a.createElement("div")).addClass("mosaic-grid-cell").append(d.clone(!0).removeClass("mosaic-original-tile mosaic-helper-tile mosaic-helper-tile-new mosaic-tile-align-right mosaic-tile-align-left").css({width:"",left:"",top:""}).mosaicAddDrag().addClass("mosaic-new-tile"))),n.parent().parent().mosaicSetColumnSizes(),n.parent().parent().mosaicSetResizeHandles()}var f=d.parent().parent();t()(".mosaic-original-tile",a).remove(),e.mosaic.panels.find(".mosaic-grid-row:not(:has(.mosaic-tile))").remove(),e.mosaic.panels.find(".mosaic-empty-row").remove(),f.mosaicCleanupRow(),e.mosaic.panels.mosaicAddEmptyRows();var v=t()(".mosaic-new-tile",a);v.removeClass("mosaic-new-tile");var g=new r.default(e.mosaic,v),C=d.find(".mosaic-tile-content");C.length>0&&C[0]._preScanHTML&&g.cacheHtml(C[0]._preScanHTML),g.isRichText()||g.scanRegistry(),t()('.mosaic-tile:not(".mosaic-helper-tile") .mosaic-tile-content.mosaic-rich-text').each((function(){new r.default(e.mosaic,t()(this).parent()).setupWysiwyg()})),l&&g.focus()},t().fn.mosaicSetColumnSizes=function(){return this.each((function(){var a=[],i=t()(this).children(".mosaic-grid-cell").length;t()(this).children(".mosaic-grid-cell").each((function(s){t()(this).removeClass(e.layout.widthClasses.join(" ")).removeClass(e.layout.positionClasses.join(" "));var o=0,n=Math.floor(12/i),c=12-n*(i-1);u.info("------"),u.info("position",o),u.info("col_size",n),u.info("col_size_last",c),u.info("nr_of_columns",i),u.info("------");for(var l=0;l<i;l++)l>0&&(o+=n),l===i-1&&(n=c),s===l&&(a.push(n),t()(this).addClass("col"))})),t()(this).data("column_sizes",a)}))},t().fn.mosaicSetResizeHandles=function(){return this.each((function(){t()(this).children(".mosaic-resize-handle").remove();var e=t()(this).children(".mosaic-grid-cell").length;if(e>1&&e<=12){u.info("nr_of_columns > 1 && nr_of_columns <= 12");for(var i=[],s=0,o=0,n=0;n<e;n++){var c=w(t()(t()(this).children(".mosaic-grid-cell").get(n)).mosaicGetWidthClass());i.push(c),o+=c,0===c&&(s+=1)}var l=0;s&&(l=(12-o)/s);var r=0,d=0;c=0;for(var m=0;m<e;m++)r+=c=i[m]?i[m]:l,d=Math.round(r/12*1e4)/100,u.info("resize_col_size",r),t()(this).append(t()(a.createElement("div")).addClass("mosaic-resize-handle mosaic-resize-handle-"+(m+1)+" mosaic-resize-"+r).data("resize_handle_index",m).css({marginLeft:d+"%"}));u.info("$.fn.mosaicSetResizeHandles"),u.info("column_sizes",i),u.info("zero_count",s),u.info("col_size",c)}t()(this).children(".mosaic-resize-handle").mousedown((function(){var e=t()(this).parent().children(".mosaic-grid-cell"),i=e.length,s=[];if(i>1&&i<=12)for(var o=0;o<i;o++){var n=w(t()(e.get(o)).mosaicGetWidthClass());s.push(n)}e.each((function(e){var i=t()(this).mosaicGetWidthClass(),o=i.replace("col","mosaic-col"),n=w(i);0==n&&(n="0 (2)");var c="mosaic-resize-0";if(s.length>1&&e>0){for(var l=0,r=0;r<e;r++)l+=s[r];c="mosaic-resize-"+l}t()(this).parent().append(t()(a.createElement("div")).addClass("mosaic-resize-placeholder "+i+" "+o+" "+c).append(t()(a.createElement("div")).addClass("mosaic-resize-placeholder-inner-border").append(t()(a.createElement("div")).addClass("info").html(n))))}));var c=t()(this).mosaicGetResizeHandleClassId();return t()(this).parent().append(t()(a.createElement("div")).addClass("mosaic-resize-handle mosaic-resize-handle-helper").addClass(t()(this).mosaicGetPositionClass().replace("position","resize")).data("row_width",t()(this).parent().width()).data("nr_of_columns",i).data("column_sizes",s).data("resize_handle_index",c)),t()(this).parents("[data-panel]").addClass("mosaic-panel-resizing"),t()(this).parent().addClass("mosaic-row-resizing"),t()(".mosaic-selected-tile",a).children(".mosaic-tile-content").trigger("blur"),!1}))}))},t().fn.mosaicCleanupRow=function(){return this.each((function(){var e=t()(this);if(e.children(".mosaic-grid-cell").each((function(){0===t()(this).children().length&&(t()(this).remove(),e.mosaicSetColumnSizes())})),0===e.find(".mosaic-tile").length){var a=e;if(e.nextAll(".mosaic-grid-row").length>0)e=e.next(".mosaic-grid-row");else{if(!(e.prevAll(".mosaic-grid-row").length>0))return void e.remove();e=e.prev(".mosaic-grid-row")}a.remove()}e.mosaicSetResizeHandles()}))},t().fn.mosaicGetDirection=function(e){var a=parseFloat(t()(this).width()),i=parseFloat(t()(this).height()),s=parseFloat(e.pageX-t()(this).offset().left-a/2),o=parseFloat(e.pageY-t()(this).offset().top-i/2),n=a/2,c=i/2;return s<0?o<0?s/o<-1*n/(-1*c)?"top":"left":s/o<-1*n/c?"left":"bottom":o<0?s/o<1*n/(-1*c)?"right":"top":s/o<n/c?"bottom":"right"}}}],i&&p(a.prototype,i),s&&p(a,s),Object.defineProperty(a,"prototype",{writable:!1}),e}(),v=function(e,a){var i=document.createElement("a"),s=void 0===a?"":" ("+a+")";return i.href="javascript:",i.textContent="Reset"+s,t()(i).on("click",{el:e},(function(e){e.preventDefault(),e.data.el.parent().parent().removeClass("col-1 col-2 col-3 col-4 col-5 col-6 col-7 col-8 col-9 col-10 col-11 col-12").addClass("col"),e.data.el.parent().parent().parent().mosaicSetResizeHandles(),t()(e.target).parent().parent().remove()})),i};function g(){for(var e=[],a=0;a<99;)e.push(Math.round(a+=8.333333333333334));return e}function C(e){return e?"col-"+e:"col"}function w(e,a){a=a||"col-";for(var i=0;i<12;i++)if(e===a+(i+1))return i+1;return 0}}}]);
//# sourceMappingURL=60185.393fc4e551861dc2b9d1.min.js.map