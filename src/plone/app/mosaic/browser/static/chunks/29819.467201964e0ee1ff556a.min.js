"use strict";(self.webpackChunkplone_mosaic=self.webpackChunkplone_mosaic||[]).push([[29819],{29819:function(e,a,o){o.r(a);o(35666);var t=o(65311),n=o.n(t),i=o(83364);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function c(e,a){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=function(e,a){if(!e)return;if("string"==typeof e)return l(e,a);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return l(e,a)}(e))||a&&e&&"number"==typeof e.length){o&&(e=o);var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,c=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return r=e.done,e},e:function(e){c=!0,i=e},f:function(){try{r||null==o.return||o.return()}finally{if(c)throw i}}}}function l(e,a){(null==a||a>e.length)&&(a=e.length);for(var o=0,t=new Array(a);o<a;o++)t[o]=e[o];return t}function s(e,a){for(var o=0;o<a.length;o++){var t=a[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}var m=function(e){return e.replace(/(_|\.|\/)/g,"-").toLowerCase()},d=function(){function e(a,o){var t,r,l;!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e),l=function(){var e,a,o=this;o.mosaic.layoutManager.disableEditHtmlSource();var t=n()(".mosaic-selected-tile");t.length>0&&(e=new i.default(o.mosaic,t).getType()),a=o.mosaic.options.default_available_actions;var r,l=c(o.mosaic.options.tiles);try{for(l.s();!(r=l.n()).done;){var s,m=c(r.value.tiles);try{for(m.s();!(s=m.n()).done;){var d=s.value;d.name===e&&(a=a.concat(d.available_actions))}}catch(e){m.e(e)}finally{m.f()}}}catch(e){l.e(e)}finally{l.f()}t.hasClass("removable")||(a=n()(a).filter((function(){return"remove"!==this}))),o.$el.find(".mosaic-option-group").show(),o.$el.find(".mosaic-button").hide(),o.$el.find(".mosaic-menu-format").find(".mosaic-option").hide().attr("disabled","disabled"),n()(o.$el.find(".mosaic-menu-format").find(".mosaic-option").get(0)).show().removeAttr("disabled");var u,p=c(a);try{for(p.s();!(u=p.n()).done;){var f=u.value;if(o.mosaic.actionManager.actions[f]&&!o.mosaic.actionManager.actions[f].visible())return;o.$el.find(".mosaic-button-"+f).show(),o.$el.find(".mosaic-icon-menu-"+f).show(),o.$el.find(".mosaic-option-"+f).show().removeAttr("disabled")}}catch(e){p.e(e)}finally{p.f()}o.mosaic.actionManager.actions.layout.visible()&&n()(".mosaic-button-layout").show(),o.$el.find(".mosaic-menu-insert").children(".mosaic-option-group-fields").children().each((function(){0===o.mosaic.panels.find(".mosaic-"+n()(this).attr("value")+"-tile").length?n()(this).show().removeAttr("disabled"):n()(this).hide().attr("disabled","disabled")})),o.$el.find(".mosaic-option-group").each((function(){0===n()(this).children(":enabled").length&&n()(this).hide()})),!o.mosaic.hasContentLayout&&o.mosaic.options.canChangeLayout?n()(".mosaic-button-savelayout").show():n()(".mosaic-button-savelayout").hide(),!o.mosaic.overlay.app&&!o.mosaic.saving&&!o.mosaic.modal&&(new Date).getTime()-o.lastChange>6e3&&(o.mosaic.queue((function(e){o.mosaic.layoutManager.saveLayoutToForm(),n()("#form-widgets-ILayoutAware-customContentLayout, [name='form.widgets.ILayoutAware.customContentLayout']").trigger("blur"),e()})),o.lastChange=(new Date).getTime())},(r="SelectedTileChange")in(t=this)?Object.defineProperty(t,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[r]=l;var s=this;s.mosaic=a,s.$el=n()(document.createElement("div")).addClass("mosaic-toolbar bg-light position-fixed top-0 start-0 end-0 p-2 border-bottom shadow-sm"),n()("body").prepend(s.$el),s.lastChange=(new Date).getTime()}var a,o,t;return a=e,(o=[{key:"initToolbar",value:function(){var e,a,o,t,i,r=this;for(o in r.$el.html(""),r.$el.append(n()(document.createElement("div")).addClass("mosaic-inline-toolbar w-100")),r.$el=r.$el.children(".mosaic-inline-toolbar"),r.$el.append(n()(document.createElement("div")).addClass("mosaic-toolbar-content d-flex justify-content-between")),a={},(e=r.$el.children(".mosaic-toolbar-content")).append(n()(document.createElement("div")).addClass("mosaic-toolbar-primary-functions d-flex d-grid gap-2")),a.primary_actions=e.children(".mosaic-toolbar-primary-functions"),e.append(n()(document.createElement("div")).addClass("mosaic-toolbar-secondary-functions d-flex d-grid gap-2")),a.secondary_actions=e.children(".mosaic-toolbar-secondary-functions"),a){var l,s=c(r.mosaic.options[o]);try{for(s.s();!(l=s.n()).done;){var d=l.value;if(void 0===d.actions)r.AddControl(a[o],d);else{t=d;var u=m(d.name),p=n()(document.createElement("div")).addClass("d-flex mosaic-button-group mosaic-button-group-"+u);p.append(r.AddControl(p,n().extend({},!0,t,{action:t.name.toLowerCase(),name:t.name.toLowerCase()})));var f=n()(document.createElement("div")).addClass("btn-container d-flex d-grid gap-2");for(p.append(f),a[o].append(p),i=0;i<t.actions.length;i+=1)r.AddControl(f,t.actions[i])}}}catch(e){s.e(e)}finally{s.f()}}r._mosaicToolbarLayoutEditor(a),r.mosaic.hasContentLayout&&n()(".mosaic-toolbar-secondary-functions",r.$el).addClass("d-none"),r.SelectedTileChange()}},{key:"AddControl",value:function(e,a){var o,t=this;void 0!==r(a.menu)&&a.menu?a.icon?(o=n()(document.createElement("label")),e.append(o.addClass("mosaic-icon-menu mosaic-icon-menu-"+m(a.name)+" mosaic-icon").html(a.label).attr("title",a.label).append(n()(document.createElement("select")).addClass("mosaic-menu-"+m(a.name)).data("action",a.action).on("change",(function(e){t.mosaic.actionManager.execAction(a.action,e.target)})).each((function(){var e,o,t,i=c(a.items);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(void 0!==r.items)for(o in n()(this).append(n()(document.createElement("optgroup")).addClass("mosaic-option-group mosaic-option-group-"+m(r.value)).attr("label",r.label)),e=n()(this).find(".mosaic-option-group-"+m(r.value)),r.items)e.append(n()(document.createElement("option")).attr("value",r.items[o].value).addClass("mosaic-option mosaic-option-"+m(r.items[o].value)).html(r.items[o].label));else n()(this).append(n()(document.createElement("option")).attr("value",r.value).addClass("mosaic-option mosaic-option-"+m(r.value)).html(r.label))}}catch(e){i.e(e)}finally{i.f()}}))))):(o=n()(document.createElement("select")),e.append(o.addClass("pat-select2 mosaic-menu mosaic-menu-"+a.name.replace(/_/g,"-")).attr("data-pat-select2",JSON.stringify({minimumResultsForSearch:-1})).on("change",(function(e){t.mosaic.actionManager.execAction(a.action,e.target)})).each((function(){var e,o,t=c(a.items);try{for(t.s();!(o=t.n()).done;){var i=o.value;if(void 0!==i.items){n()(this).append(n()(document.createElement("optgroup")).addClass("mosaic-option-group mosaic-option-group-"+m(i.value)).attr("label",i.label)),e=n()(this).find(".mosaic-option-group-"+m(i.value));var r,l=c(i.items);try{for(l.s();!(r=l.n()).done;){var s=r.value;e.append(n()(document.createElement("option")).attr("value",s.value).addClass("mosaic-option mosaic-option-"+m(s.value)).html(s.label))}}catch(e){l.e(e)}finally{l.f()}}else n()(this).append(n()(document.createElement("option")).attr("value",i.value).addClass("mosaic-option mosaic-option-"+m(i.value)).html(i.label))}}catch(e){t.e(e)}finally{t.f()}})))):"layout"==m(a.name)?(o=n()(document.createElement("div")),e.append(o.addClass("ms-3 d-flex align-items-center me-2 text-secondary mosaic-button mosaic-button-"+m(a.name)+(a.icon?" mosaic-icon":"")).html(a.label))):(o=n()(document.createElement("button")),e.append(o.addClass("btn btn-sm btn-secondary mosaic-button mosaic-button-"+m(a.name)+(a.icon?" mosaic-icon":"")).html(a.label).attr("title",a.label).attr("type","button").data("action",a.action).on("mousedown",(function(e){t.mosaic.actionManager.execAction(a.name,e.target)})))),t.mosaic.actionManager.actions[a.name]&&(t.mosaic.actionManager.actions[a.name].visible()||o.hide())}},{key:"_mosaicToolbarLayoutEditor",value:function(e){var a,o=this;if(n()(".mosaic-toolbar-secondary-functions",o.$el).removeClass("d-none"),void 0!==o.mosaic.options.formats){var t,i=c(o.mosaic.options.formats);try{for(i.s();!(t=i.n()).done;){var r=t.value;e.primary_actions.append(n()(document.createElement("fieldset")).addClass("d-flex d-grid gap-2 btn-group mosaic-button-group mosaic-button-group-"+m(r.name))),a=e.primary_actions.children(".mosaic-button-group-"+r.name.replace(/_/g,"-"));var l,s=c(r.actions);try{for(s.s();!(l=s.n()).done;){var d=l.value;d.favorite&&o.AddControl(a,d)}}catch(e){s.e(e)}finally{s.f()}0===a.children().length&&a.remove()}}catch(e){i.e(e)}finally{i.f()}}if(void 0!==o.mosaic.options.tiles){var u,p=e.secondary_actions.find(".mosaic-menu-insert"),f=c(o.mosaic.options.tiles);try{for(f.s();!(u=f.n()).done;){var v=u.value;p.append(n()(document.createElement("optgroup")).addClass("mosaic-option-group mosaic-option-group-"+m(v.name)).attr("label",v.label)),a=e.secondary_actions.find(".mosaic-option-group-"+m(v.name));var b,h=c(v.tiles);try{for(h.s();!(b=h.n()).done;){var y=b.value;a.append(n()(document.createElement("option")).addClass("mosaic-option mosaic-option-"+m(y.name)).attr("value",y.name).html(y.label))}}catch(e){h.e(e)}finally{h.f()}0===a.children().length&&a.remove()}}catch(e){f.e(e)}finally{f.f()}}if(void 0!==o.mosaic.options.formats){var g,C=e.secondary_actions.find(".mosaic-menu-format"),w=c(o.mosaic.options.formats);try{for(w.s();!(g=w.n()).done;){var E=g.value;C.append(n()(document.createElement("optgroup")).addClass("mosaic-option-group mosaic-option-group-"+m(E.name)).attr("label",E.label)),a=e.secondary_actions.find(".mosaic-option-group-"+m(E.name));var $,A=c(E.actions);try{for(A.s();!($=A.n()).done;){var _=$.value;!1===_.favorite&&a.append(n()(document.createElement("option")).addClass("mosaic-option mosaic-option-"+m(_.name)).attr("value",_.name).html(_.label).data("action",_.action))}}catch(e){A.e(e)}finally{A.f()}0===a.children().length&&a.remove()}}catch(e){w.e(e)}finally{w.f()}}}}])&&s(a.prototype,o),t&&s(a,t),Object.defineProperty(a,"prototype",{writable:!1}),e}();a.default=d}}]);
//# sourceMappingURL=29819.467201964e0ee1ff556a.min.js.map